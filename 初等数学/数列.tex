\chapter{数列}
\section{数列的概念}
\begin{definition}\label{definition.数列.数列的定义}
一般地，如果\(D \subseteq \mathbb{Z}\)，那么称映射\(f\colon D\to\mathbb{R}, n \mapsto a_n\)为一个\textbf{数列}（sequence），记作\(\{a_n\}\)，即\(\{a_n\} \defeq f\).

数列中的每一个数（例如\(\v{a}{0}\)）叫做数列的\textbf{项}.
表示第\(n\)个数的公式叫做数列的\textbf{一般项}.
\end{definition}

\section{数列的连加与连乘}
\begin{definition}[连加]
定义\(\sum\limits_{i=m}^{n} {a_i} = a_m+a_{m+1}+\dotsb+a_{n-1}+a_n \quad (m \leqslant n)\)为\textbf{连续求和}，其中符号\(\sum\)称作\textbf{连加号}，\(i\)称为\textbf{求和指标}.
\end{definition}
使用双重连加号求和时，如果两个求和指标独立取值，则连加号\(\sum\)的顺序可以交换.

\begin{definition}[连乘]
定义\(\prod\limits_{i=m}^{n} {a_i} = a_m \times a_{m+1} \times \dotsb \times a_{n-1} \times a_n \quad (m \leqslant n)\)为\textbf{连续求积}，其中符号\(\prod\)称作\textbf{连乘号}.
\end{definition}

\begin{definition}
给定一个正整数\(n\)，称所有小于或等于\(n\)的正整数的积为它的\textbf{阶乘}（factorial），记作\(n!\)，即\begin{equation}
n! = n \times (n-1) \times (n-2) \times \dotsm \times 2 \times 1
= \prod\limits_{k=1}^n k!.
\end{equation}
特别地，规定\(0! = 1\).
\end{definition}

\begin{definition}
给定一个正整数\(n\)，称小于或等于\(n\)且与之同奇偶的所有正整数的积为它的\textbf{双阶乘}，记作\(n!!\)，即\begin{equation}
n!! = \begin{cases}
n \times (n-2) \times (n-4) \times \dotsm \times 3 \times 1, & n\text{是奇数}, \\
n \times (n-2) \times (n-4) \times \dotsm \times 4 \times 2, & n\text{是偶数}.
\end{cases}
\end{equation}
\end{definition}
需要注意的是，双阶乘\(n!!\)并不等于“阶乘的阶乘”\((n!)!\)，%
实际上，\(3!! = 3\)而\((3!)! = 6! = 720\).

\section{常见数列}
\subsection{等差数列}
\begin{definition}
一般地，如果一个数列从第2项起，每一项与它的前一项的差等于同一个常数，这个数列就叫做\textbf{等差数列}，这个常数叫做等差数列的\textbf{公差}.
\end{definition}

如果数列\(\{a_n\}\)是等差数列，它的公差是\(d\)，那么\begin{align*}
a_2 &= a_1 + d, \\
a_3 &= a_2 + d = (a_1 + d) + d = a_1 + 2d, \\
a_4 &= a_3 + d = (a_1 + 2d) + d = a_1 + d3.
\end{align*}以此类推，可知等差数列\(\{a_n\}\)的通项公式是\[
a_n = a_1 + (n-1) d.
\]

等差数列的递推公式为\[
a_n - a_{n-1} = d, \quad n \geqslant 2.
\]

\begin{property}[等差数列求和]
设数列\(\{a_n\}\)为等差数列\[
a_n = a_1 + (n-1) d,
\]则有\[
S_n = \sum\limits_{i=1}^n a_i
= \frac{n(a_1 + a_n)}{2}
= n a_1 + \frac{n(n-1)}{2} d
\]
\begin{proof}
由\[
S_n = a_1 + (a_1 + d) + \dotsb + [a_1 + (n-2)d] + [a_1 + (n-1)d],
\]\[
S_n = [a_n - (n-1)d] + [a_n - (n-2)d] + \dotsb + (a_n - d) + a_n,
\]相加得\[
2 S_n = n(a_1 + a_n),
\]最终可得\[
S_n = \frac{n(a_1 + a_n)}{2} = n a_1 + \frac{n(n-1)}{2} d.
\qedhere
\]
\end{proof}
\end{property}

\subsection{等比数列}
\begin{definition}
如果数列\(\{a_n\}\)满足\[
a_n = a_1 q^{n-1} \quad(q\neq1),
\]则称该数列为\textbf{等比数列}.其中\(q\)称作\textbf{公比}.

等比数列的递推公式为\(\frac{a_n}{a_{n-1}} = q\)（\(n \geqslant 2\)）.
\end{definition}

\begin{property}[等比数列求和]
设数列\(\{a_n\}\)为等比数列\[
a_n = a_1 q^{n-1} \qquad (q \neq 1)
\]则有\[
S_n = \sum\limits_{i=1}^n a_i
= \left\{ \begin{array}{cl}
\frac{a_1 (q^n-1)}{q-1}, & q \neq 1, \\
na, & q = 1.
\end{array} \right.
\]
\begin{proof}
当\(q = 1\)时，显然有\(S_n = na\).
当\(q \neq 1\)时，有\[
q S_n = aq+aq^2+aq^3+\dotsb+aq^n,
\]\[
S_{n+1} = a+aq+aq^2+\dotsb+aq^{n-1}+aq^n,
\]因此\[
S_{n+1} - q S_n = a.
\]又因为\(S_{n+1} - S_n = aq^n\)，所以\[
(q-1) S_n = (S_{n+1} - S_n) - (S_{n+1} - q S_n) = aq^n - a = a(q^n - 1),
\]\[
S_n = \frac{a(q^n - 1)}{q-1}.
\qedhere
\]
\end{proof}
\end{property}

\begin{property}
设数列\(\{a_n\}\)为等差数列，\(b\)为常数，则：
\begin{enumerate}
\item \(\{b + a_n\}\)为等差数列；
\item \(\{b \cdot a_n\}\)为等差数列；
\item \(\{b^{a_n}\}\)为等比数列.
\end{enumerate}
\end{property}

\begin{property}
设数列\(\{a_n\}\)为等比数列，\(b\)为常数，则：
\begin{enumerate}
\item \(\{b \cdot a_n\}\)为等比数列；
\item \(\{\frac{b}{a_n}\}\)为等比数列；
\item \(\{\log_b a_n\}\)为等差数列.
\end{enumerate}
\end{property}

\begin{example}
\(\sum\limits_{i=1}^n i = 1 + 2 + \dotsb + n = \frac{1}{2} n(n+1)\).
\end{example}

\begin{example}
\(\sum\limits_{i=1}^n i^2 = 1^2 + 2^2 + \dotsb + n^2 = \frac{1}{6} n(n+1)(2n+1)\).
\end{example}

\begin{example}
\(\sum\limits_{i=1}^n i^3 = 1^3 + 2^3 + \dotsb + n^3 = \left[\frac{n(n+1)}{2}\right]^2\).
\end{example}

\subsection{斐波那契数列}
如果数列\(\{a_n\}\)满足\(a_1=a_2=1\)，且\[
a_n = a_{n-1} + a_{n-2} \quad(n\geqslant3),
\]则称该数列为\DefineConcept{斐波那契数列}.

\section{已知递推公式求解通项公式的方法}
\subsection{\texorpdfstring{形如\(a_{n+2}=p a_{n+1} + q a_n\ (q\neq0)\)的递推公式}{第一类递推公式}}
对于形如\(a_{n+2}=p a_{n+1} + q a_n\ (q\neq0)\)的递推公式，我们可以令\[
\mat{X}_n = \begin{bmatrix}
a_{n+1} \\
a_n
\end{bmatrix},
\qquad
\mat{A} = \begin{bmatrix}
p & q \\
1 & 0
\end{bmatrix},
\]则\(\mat{X}_{n+1} = \mat{A} \mat{X}_n\)，从而\(\mat{X}_n = \mat{A}^{n-1} \mat{X}_1\).
这样就可以求出通项公式.

现在我们来求\(\mat{A}\)的幂.
此时\(\mat{A}\)的特征多项式为\[
f(x) = \begin{vmatrix}
x-p & -q \\
-1 & x
\end{vmatrix} = x^2 - px - q,
\]我们也称这个多项式为递推公式的特征方程.

假设我们求得该方程的两个复根为\(\alpha,\beta\)，则由韦达定理可知\(p=\alpha+\beta, q=-\alpha\beta\).
注意到\[
\left\{ \begin{array}{l}
a_{n+2} - \alpha a_{n+1} = \beta(a_{n+1}-\alpha a_n), \\
a_{n+2} - \beta a_{n+1} = \alpha(a_{n+1}-\beta a_n)
\end{array} \right.,
\]从而\[
\left\{ \begin{array}{l}
a_{n+1} - \alpha a_n = \beta^{n-1} (a_2 - \alpha a_1), \\
a_{n+1} - \beta a_n = \alpha^{n-1} (a_2 - \beta a_1)
\end{array} \right.,
\]

若\(\alpha\neq\beta\)，解关于\(a_{n+1},a_n\)的线性方程组可得\[
a_n = \frac{\beta^{n-1} (a_2 - \alpha a_1) - a^{n-1} (a_2 - \beta a_1)}{\beta-\alpha};
\]
若\(\alpha=\beta\)，则\(\alpha=\beta\neq0\)，从而\(a_{n+1} = \alpha a_n = \alpha^{n-1} (a_2 - \alpha a_1)\)，进而\[
\frac{a_{n+1}}{\alpha^{n+1}} - \frac{a_n}{\alpha^n} = \frac{1}{\alpha^2}(a_2-\alpha a_1),
\]最后得到\[
a_n = (2-n)\alpha^{n-1} a_1 + (n-1) \alpha^{n-2} a_2.
\]

利用上述结论可以求出斐波那契数列的通项公式为\[
a_n = \frac{1}{\sqrt{5}} \left[
\left(\frac{1+\sqrt{5}}{2}\right)^n
-\left(\frac{1-\sqrt{5}}{2}\right)^n
\right].
\]

\subsection{\texorpdfstring{形如\(a_{n+1} = \frac{a a_n + b}{c a_n + d}\ (ad-bc\neq0)\)的递推公式}{第二类递推公式}}
对于形如\(a_{n+1} = \frac{a a_n + b}{c a_n + d}\ (ad-bc\neq0)\)的递推公式\footnote{这里\(ad-bc\neq0\)确保分式不可能恒为常数（即分式不能约分）.}，首先考虑特征方程\[
x = \frac{ax+b}{cx+d},
\]整理得\[
cx^2+(d-a)x-b=0,
\]解得\[
\alpha=\frac{(a-d)-\sqrt{(d-a)^2+4bc}}{2c}, \qquad
\beta=\frac{(a-d)+\sqrt{(d-a)^2+4bc}}{2c}.
\]由韦达定理，有\[
\alpha+\beta=\frac{a-d}{c}, \qquad
\alpha\beta=-\frac{b}{c};
\]因此\[
a_{n+1} = \frac{\left(\alpha+\beta+\frac{d}{c}\right) a_n - \alpha\beta}{a_n + \frac{d}{c}}.
\]

接下来分成两种情况讨论：\begin{enumerate}
\item 若\(\alpha\neq\beta\)，则\[
\frac{a_{n+1}-\alpha}{a_{n+1}-\beta}
= \frac{\left(\alpha+\beta+\frac{d}{c}\right) a_n - \alpha\beta - \alpha \left(a_n + \frac{d}{c}\right)}{\left(\alpha+\beta+\frac{d}{c}\right) a_n - \alpha\beta - \beta \left(a_n + \frac{d}{c}\right)}
= \frac{c\beta+d}{c\alpha+d} \frac{a_n-\alpha}{a_n-\beta}.
\]记\(b_n = \frac{a_n-\alpha}{a_n-\beta}\)，则\(b_{n+1} = \frac{c\beta+d}{c\alpha+d} b_n\).

\item 若\(\alpha=\beta=\frac{a-d}{2c}\)，则\[
a_{n+1} = \frac{\left(2\alpha+\frac{d}{c}\right) a_n - \alpha^2}{a_n + \frac{d}{c}}
= \frac{(2c\alpha+d)a_n-c\alpha^2}{c a_n+d},
\]进而有\[
\frac{1}{a_{n+1}-\alpha}=\frac{1}{a_n-\alpha}+\frac{1}{\alpha+\frac{d}{c}}.
\]记\(b_n = \frac{1}{a_n-\alpha}\)，则\(b_{n+1} = b_n + \frac{1}{\alpha+\frac{d}{c}}\).
\end{enumerate}
