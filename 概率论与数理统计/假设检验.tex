\chapter{假设检验}
\section{假设检验的基本概念}
\subsection{假设检验的基本思想}
\textbf{假设检验}问题是指判断样本与样本、样本与总体的差异是不是由系统误差引起.
其一般形式是：总体\(X \sim N(\mu,\sigma_0^2)\)，其中\(\sigma_0^2\)已知.自总体\(X\)取得样本\(\v{X}{n}\)及样本观测值\(\v{x}{n}\).
当测量不存在系统误差时，测量值的分布的均值\(\mu\)应等于真实值\(\mu_0\).故可提出两个相互对立的假设：\[
H_0: \mu=\mu_0; \qquad H_1: \mu\neq\mu_0.
\]其中\(H_0\)称为\textbf{原假设}，\(H_1\)称为\textbf{备选假设}.这样，判断测量是否存在系统误差又等价于判断\(H_0\)成立还是\(H_1\)成立.

注意样本均值\(\overline{X}\)是总体期望\(\mu\)的无偏估计，因此\begin{enumerate}
\item 若\(H_0\)成立，即\(\mu=\mu_0\)，故\(\overline{X}\)与\(\mu_0\)偏差的绝对值\(\abs{\overline{X}-\mu_0}\)取值应相对较小，它的取值反映的是样本均值所产生的抽样误差；
\item 若\(H_1\)成立，即\(\mu\neq\mu_0\)，则\(\abs{\overline{X}-\mu_0}\)取值应相对较大，它的取值主要反映的是\(\mu\neq\mu_0\)所产生的系统误差.
\end{enumerate}

因此判断\(H_0\)成立还是\(H_1\)成立转化为判断\(\abs{\overline{X}-\mu_0}\)取值的相对大小.

而\(\abs{\overline{X}-\mu_0}\)取值的相对大小又与\[
\abs{U}=\frac{\abs{\overline{X}-\mu_0}}{\sigma_0 / \sqrt{n}}
\]的相对大小一致.这就需要一个临界值，以判断\(\abs{U}\)的相对大小.

我们取一个很小的正数\(\alpha\)（如0.01、0.05），称之为\textbf{显著性水平}.假定\(H_0\)成立，此时有\[
U = \frac{\overline{X}-\mu_0}{\sigma_0 / \sqrt{n}} \sim N(0,1),
\]从而有\begin{align*}
P(\abs{U}>u_{1-\frac{\alpha}{2}})
&=P(U>u_{1-\frac{\alpha}{2}})+P(U<-u_{1-\frac{\alpha}{2}}) \\
&=1 - P(U \leqslant u_{1-\frac{\alpha}{2}}) + P(U<u_{\frac{\alpha}{2}}) \\
&=1 - (1-\frac{\alpha}{2}) + \frac{\alpha}{2}
=\alpha.
\end{align*}
这样，推出事件\((\abs{U}>u_{1-\frac{\alpha}{2}})\)是一个小概率事件.根据小概率事件在一次试验中是几乎不可能发生的小概率原理，因此在\(H_0\)成立的假定下，事件\((\abs{U}>u_{1-\frac{\alpha}{2}})\)是几乎不可能发生的.

如果经过计算发现\(\abs{u}=\frac{\abs{\overline{x}-\mu_0}}{\sigma_0 / \sqrt{n}}>u_{1-\frac{\alpha}{2}}\)成立，即小概率事件\((\abs{U}>u_{1-\frac{\alpha}{2}})\)竟然发生了，由小概率原理说明这个事件发生的概率并不小，这与推导出该事件是小概率事件矛盾，也就说明前面假定\(H_0\)成立是错误的，从而拒绝\(H_0\)成立而接受\(H_1\)成立，或者说测量存在系统误差.

但要注意，假设检验的结论与显著性水平\(\alpha\)密切相关.不同的显著性水平下可能得出相反的结论.因此，假设检验的结论必须说明是在什么样的显著性水平\(\alpha\)下得到的.

上面的推导方法反映了一般假设检验的思想方法.假设检验又叫\textbf{显著性检验}，其中\(U\)叫做\textbf{检验统计量}；\(u_{1-\frac{\alpha}{2}}\)叫做临界值；\(W=\{\abs{U}>u_{1-\frac{\alpha}{2}}\}\)叫做检验的\textbf{拒绝域}.

一般地，拒绝域在原假设\(H_0\)成立时是一个小概率事件.当样本观测值代入检验统计量使得这个小概率事件发生了，则应拒绝\(H_0\)成立，从而接受备选假设\(H_1\)成立.若样本观测值代入时这个小概率事件没有发生，则接受\(H_0\)成立.

\subsection{双侧检验与单侧检验}
在上一小节中，备选假设\(H_1\)为\(\mu\neq\mu_0\)，\(\mu\)位于\(\mu_0\)两端.这样的检验叫做\textbf{双侧检验}.注意此检验的拒绝域\(W=\{\abs{U}>u_{1-\frac{\alpha}{2}}\}\)也位于两端.

但实际情况中也常常遇到单侧检验问题.例如，若我们已经知道测量值不会偏低，则我们关心的是测量值是否有偏大的系统误差，即应该检验\[
H_0: \mu=\mu_0\ \text{（或}\mu\leqslant\mu_0\text{）}; \qquad H_1: \mu>\mu_0.
\]这样的检验，因备择假设\(H_1\)中\(\mu\)位于\(\mu_0\)右侧，所以这个检验叫做\textbf{右侧检验}.对于总体\(X \sim N(\mu,\sigma_0^2)\)，显著性水平为\(\alpha\)时，检验统计量为\(U = \frac{\overline{X}-\mu_0}{\sigma_0 / \sqrt{n}}\)，拒绝域为\(W=\{U>u_{1-\alpha}\}\).需要注意的是，不同的两种原假设\(\mu=\mu_0\)和\(\mu\leqslant\mu_0\)在实际意义上虽有区分，但其检验统计量与拒绝域都相同，故在理论上没有区分.

相反地，如果原假设为\(H_0: \mu=\mu_0\ \text{（或}\mu\geqslant\mu_0\text{）}\)，备择假设为\(H_1: \mu<\mu_0\)，即备择假设\(H_1\)中\(\mu\)位于\(\mu_0\)左侧，则称之为\textbf{左侧检验}.对于总体\(X \sim N(\mu,\sigma_0^2)\)，显著性水平为\(\alpha\)时，检验统计量为\(U = \frac{\overline{X}-\mu_0}{\sigma_0 / \sqrt{n}}\)，拒绝域为\(W=\{U<-u_{1-\alpha}\}\).

右侧检验与左侧检验合称\textbf{单侧检验}.

\subsection{两类错误}
由前所述，拒绝域是依据小概率原理推出的.但“几乎不可能发生”不等于“一定不发生”，因此假设检验的结论有可能是错误的.这种错误有两类：

第一类错误叫做“弃真”，即当\(H_0\)确实是正确的，但检验统计量的值却落入了拒绝域，我们就拒绝了\(H_0\).

第二类错误叫做“取伪”，即当\(H_0\)确实是错误的，但检验统计量的值却未落入拒绝域，我们就接受了\(H_0\).

犯第一类错误的概率是不大于显著性水平\(\alpha\)的.例如，在右侧检验时，对于总体\(X \sim N(\mu,\sigma_0^2)\)，检验统计量为\(U = \frac{\overline{X}-\mu_0}{\sigma_0 / \sqrt{n}} \sim N(0,1)\)，原假设\(H_0: \mu\leqslant\mu_0\)为真时，拒绝\(H_0\)的概率为\[
P\left(U=\frac{\overline{X}-\mu_0}{\sigma_0 / \sqrt{n}}>u_{1-\alpha}\right) \leqslant P\left(U=\frac{\overline{X}-\mu}{\sigma_0 / \sqrt{n}}>u_{1-\alpha}\right) = \alpha.
\]
