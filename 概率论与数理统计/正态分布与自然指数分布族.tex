\chapter{正态分布与自然指数分布族}

在数理统计中，最重要的分布就是正态分布.
正态分布的重要性在于：
在实际问题中有许多随机变量服从（或近似服从）正态分布，例如成年男子的身高、体重，工件的测量误差，大气的温度、湿度等；
正态分布的密度函数与分布函数具有许多良好的性质；
正态分布是许多分布的极限分布；
正态分布在数理统计中的基础作用.
所以，许多实际问题与理论问题的解决，都离不开正态分布.

另外，二项分布、泊松分布、指数分布、\(\Gamma\)分布、几何分布等分布也很重要.
由于它们与正态分布具有许多统一的概率性质，这些分布都被划归为自然指数分布族.

\section{正态分布的数字特征、线性性质}
\subsection{正态分布的数字特征}
\begin{theorem}\label{theorem:正态分布与自然指数分布族.正态分布的数字特征}
设随机变量\(X \sim N(\mu,\sigma^2)\)，
则\(X\)的期望与方差分别为\[
	E(X) = \mu,
	\qquad
	D(X) = \sigma^2.
\]
\begin{proof}
设\(Y \sim N(0,1)\)，则有\begin{align*}
	E(Y) &= \int_{-\infty}^{+\infty} y \cdot \frac{1}{\sqrt{2\pi}} e^{-\frac{y^2}{2}} \dd{y} = 0, \\
	D(Y) &= E(Y^2)
	= \int_{-\infty}^{+\infty} y^2 \cdot \frac{1}{\sqrt{2\pi}} e^{-\frac{y^2}{2}} \dd{y} \\
	&= \frac{2}{\sqrt{2\pi}} \int_0^{+\infty} y^2 e^{-\frac{y^2}{2}} \dd{y} \\
	&\xlongequal{t=y^2/2} \frac{2}{\sqrt{2\pi}} \int_0^{+\infty} 2 t e^{-t} \frac{\sqrt{2}}{2} t^{-\frac{1}{2}} \dd{t} \\
	&=\frac{2}{\sqrt{\pi}} \int_0^{+\infty} t^{\frac{1}{2}} e^{-t} \dd{t} \\
	&= \frac{2}{\sqrt{\pi}} \Gamma\left(\frac{3}{2}\right)
	= \frac{2}{\sqrt{\pi}} \cdot \frac{1}{2} \Gamma\left(\frac{1}{2}\right)
	= 1.
\end{align*}
由\hyperref[definition:正态分布.正态分布的定义]{正态分布的定义}，
\(Y = \frac{X-\mu}{\sigma}\)，
\(X = \sigma Y + \mu\)，
从而\[
	E(X) = E(\sigma Y + \mu) = \sigma E(Y) + \mu = \mu,
\]\[
	D(X) = D(\sigma Y + \mu) = \sigma^2 D(Y) = \sigma^2.
	\qedhere
\]
\end{proof}
\end{theorem}

\begin{example}
设随机变量\(X\)的分布函数为\[
	F(x) = \frac{3}{10} \Phi(x) + \frac{7}{10} \Phi\left(\frac{x-1}{2}\right),
\]
其中\(\Phi(x)\)是标准正态分布的分布函数，求\(E(X)\).
\begin{solution}
对\(F(x)\)求导得\[
	f(x) = F'(x)
	= \frac{3}{10} \phi(x)
		+ \frac{7}{10} \phi\left(\frac{x-1}{2}\right) \frac{1}{2},
\]
其中\(\phi(x)\)是标准正态分布的密度函数.
那么\begin{align*}
	E(X) &= \int_{-\infty}^{+\infty} x f(x) \dd{x} \\
	&= \int_{-\infty}^{+\infty} x \frac{3}{10} \phi(x) \dd{x}
	+ \int_{-\infty}^{+\infty} x \frac{7}{10} \phi\left(\frac{x-1}{2}\right) \frac{1}{2} \dd{x} \\
	&\xlongequal{y=(x-1)/2} \frac{3}{10} \cdot 0
	+ \frac{7}{10} \int_{-\infty}^{+\infty} (2y+1) \phi(y) \dd{y}
	= \frac{7}{10}.
\end{align*}
\end{solution}
\end{example}

\subsection{正态分布的线性性质}
\begin{theorem}\label{theorem:正态分布与自然指数分布族.正态分布的线性性质}
设随机变量\(X \sim N(\mu,\sigma^2)\)，
当\(b \neq 0\)时，
有\begin{equation}
	Y = a+bX \sim N(a+b\mu,b^2\sigma^2).
\end{equation}
\begin{proof}
令\[
	Z = \frac{Y-(a+b\mu)}{\abs{b}\sigma}.
\]

当\(b > 0\)时，\[
	Z = \frac{(a+bX)-(a+b\mu)}{b\sigma}=\frac{X-\mu}{\sigma},
\]
故\(Z \sim N(0,1)\).

当\(b < 0\)时，\[
Z = \frac{(a+bX)-(a+b\mu)}{-b\sigma}=-\frac{X-\mu}{\sigma},
\]
故\(Z \sim N(0,1)\).

综上所述，\(Y \sim N(a+b\mu,b^2\sigma^2)\).
\end{proof}
\end{theorem}

\subsection{正态分布的可加性}
\begin{theorem}\label{theorem:正态分布与自然指数分布族.正态分布的可加性1}
设\(X \sim N(\mu_1,\sigma_1^2)\)，
\(Y \sim N(\mu_2,\sigma_2^2)\)，
且\(X\)与\(Y\)相互独立，
则\begin{equation}
	X+Y \sim N(\mu_1+\mu_2,\sigma_1^2+\sigma_2^2).
\end{equation}
\end{theorem}

\begin{corollary}\label{theorem:正态分布与自然指数分布族.正态分布的可加性2}
设随机变量\(\AutoTuple{X}{n}\)相互独立，且\[
	X_i \sim N(\mu_i,\sigma_i^2),
	\quad i=1,2,\dotsc,n,
\]
且\(C_1,C_2,\dotsc,C_n\)为常数，
则\begin{equation}
	\sum_{i=1}^n {C_i X_i}
	\sim N\left(
	\sum_{i=1}^n {C_i \mu_i},
	\sum_{i=1}^n {C_i^2 \sigma_i^2}
	\right).
\end{equation}
\end{corollary}

\begin{example}
设\(\AutoTuple{X}{n}\)独立同分布于\(N(\mu,\sigma^2)\)，试计算其算术平均数\[
	\overline{X} = \frac{1}{n} (X_1+X_2+\dotsb+X_n)
\]的分布.
\begin{solution}
由\hyperref[theorem:正态分布与自然指数分布族.正态分布的可加性2]{正态分布的卷积公式}可知\[
	X_1+X_2+\dotsb+X_n \sim N(n\mu,n\sigma^2).
\]又由\hyperref[theorem:正态分布与自然指数分布族.正态分布的线性性质]{正态分布的线性性}可知\[
	\overline{X} = \frac{1}{n} (X_1+X_2+\dotsb+X_n) \sim N\left(\mu,\frac{\sigma^2}{n}\right).
\]
\end{solution}
由此可见，\(n\)个独立同分布于正态分布\(N(\mu,\sigma^2)\)
的随机变量的算术平均数\(\overline{X}\)仍服从正态分布，
其均值与原分布的均值\(\mu\)相同；
但其方差缩小了\(n\)倍，变为\(\sigma^2/n\)；
其标准差缩小了\(\sqrt{n}\)倍，
变为\(\sigma/\sqrt{n}\).
这表明\(\overline{X}\)的分布更加集中，
这也是为什么在测量物体的尺寸时我们应该多次读数并取算术平均值.
\end{example}


\section{自然指数分布族}
\begin{definition}
若存在\(H \subseteq \mathbb{R}\)上的实值函数\(\phi(\theta)\)，
以及不依赖于\(\theta\)的函数\(h(x)\)，
非退化的随机变量\(X\)有概率分布或概率密度函数\[
f(x,\theta) = \exp[\theta x - \phi(\theta)] h(x),
\quad x \in G,\,\theta \in H,
\]则称\(X\)服从\DefineConcept{自然指数分布族分布}.
其中\(\theta\)叫做自然参数，\(H\)叫做\DefineConcept{自然参数空间}，
\(\phi(\theta)\)叫做\DefineConcept{累积量母函数}，
\(G\)叫做\DefineConcept{支撑集}，且\(G\)不依赖于\(\theta\).
\end{definition}

\begin{theorem}
若\(X\)服从自然指数分布族分布，则\[
E(X) = \phi'(\theta),
\quad
D(X) = \phi''(\theta),
\quad
\theta \in H.
\]
\end{theorem}

\begin{landscape}
	\begin{table}
		\centering
		\begin{tblr}{|*{5}{c|}}
			\hline
			密度函数或概率分布
				& 自然参数\(\theta\)
				& 累积量母函数\(\phi(\theta)\)
				& 均值参数\(m=\phi'(\theta)\)
				& 方差函数\(V(m) = \phi''(\theta)\) \\ \hline
			正态函数\(N(\mu,\sigma^2)\)
				& \(\frac{\mu}{\sigma^2}\)
				& \(\frac{\sigma^2 \theta^2}{2}\)
				& \(m=\mu=\theta\sigma^2\)
				& \(\sigma^2\) \\ \hline
			泊松分布\(P(\lambda)\)
				& \(\ln\lambda\)
				& \(e^{\theta}\)
				& \(m=\lambda=e^{\theta}\)
				& \(\lambda=m\) \\ \hline
			\(\Gamma\)分布\(\Gamma(\alpha,\beta)\)
				& \(-\beta\)
				& \(-\alpha\ln(-\theta)=-\alpha\ln\beta\)
				& \(m=\frac{\alpha}{\beta}=-\frac{\alpha}{\theta}\)
				& \(\frac{\alpha}{\beta^2}=\frac{m^2}{\alpha}\) \\ \hline
			二项分布\(B(n,p)\)
				& \(\ln\frac{p}{q}\)
				& \(n\ln(1+e^{\theta})=-n\ln{q}\)
				& \(m=np=\frac{n}{1+e^{-\theta}}\)
				& \(npq=-\frac{m^2}{n}+m\) \\ \hline
			负二项分布\(NB(r,p)\)
				& \(\ln{q}\)
				& \(r\ln(\frac{e^{\theta}}{1-e^{\theta}})=r\ln\frac{q}{p}\)
				& \(m=\frac{r}{q}=\frac{r}{1-e^{\theta}}\)
				& \(\frac{rq}{p^2}=\frac{m^2}{r}-m\) \\ \hline
		\end{tblr}
		\caption{常见自然指数分布族分布}
		\label{table:自然指数分布族分布.常见自然指数分布族分布}
	\end{table}
\end{landscape}

对于\cref{table:自然指数分布族分布.常见自然指数分布族分布} 有以下两点需要注意：
\begin{enumerate}
	\item 作为自然指数分布族分布，
	正态分布的参数\(\sigma^2\)和\(\Gamma\)分布的参数\(\alpha\)是作为已知的，
	且\(\alpha=1\)时\(\Gamma\)分布化为指数分布\(e(\beta)\).

	\item 当\(r=1\)时负二项分布（即帕斯卡分布）化为几何分布\(G(p)\).
\end{enumerate}

\begin{definition}
称\(m\)为自然指数分布族的\DefineConcept{均值参数}.
称均值参数\(m\)的取值区间为\DefineConcept{均值空间}，记为\(M\)，即\[
M = \{ m \vert m = \phi'(\theta), \theta \in H \}.
\]

由于\(m\)与\(\theta\)存在一一对应关系，即\(\theta = \theta(m)\)，则\[
D(X) = \phi''(\theta) = V(m),
\]称\(V(m)\)为\(X\)的\DefineConcept{方差函数}.
\end{definition}

\begin{theorem}
若\(\AutoTuple{X}{n}\)独立同服从于一个自然指数分布族分布，其方差函数为\(V(m)\)，则\(Y=X_1+X_2+\dotsb+X_n\)也服从同一个自然指数分布族分布，且\[
E(Y)=n m,
\]\[
D(Y)=n V(m).
\]
\end{theorem}
