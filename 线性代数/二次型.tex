\chapter{二次型}
为了研究几何问题（特别是平面二次曲线、空间二次曲面的方程的化简）和物理问题，我们抽象出“二次型”的概念，利用代数方法对其进行研究.

\section{二次型的基本概念}
我们首先研究平面解析几何中以坐标原点为中心的二次曲线的方程：
\begin{center}
\def\arraystretch{1.5}
\begin{tabular}{cl}
圆 & \(x^2+y^2=r^2\) \\
椭圆 & \(\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\) \\
双曲线 & \(\frac{x^2}{a^2}-\frac{y^2}{b^2}=1\) \\
\end{tabular}
\end{center}

可以看出，它们都具有\[
a x^2 + 2b xy + c y^2 = d
\]的形式.
在研究二次曲线时，如果得到的方程不是标准方程，我们通常希望通过旋转、平移等几何变换将其化为标准方程，进而判别曲线的形状和几何性质.

\subsection{二次型的基本概念}
\begin{definition}
称系数\(a_{ij}\ (1 \leq i \leq j \leq n)\)属于数域\(P\)的\(n\)个变量的二次齐次多项式\begin{equation}\label{equation:二次型.二次型}
f(\AutoTuple{x}{n})
= \sum\limits_{i=1}^n \sum\limits_{j=1}^n a_{ij} x_i x_j
\quad(a_{ji}=a_{ij})
\end{equation}为数域\(P\)上的一个\(n\)元\DefineConcept{二次型}（quadratic form）\footnote{%
本章不作特别声明时，“二次型”均指实二次型.}.
\end{definition}

数域对于一个二次齐次多项式是否成为二次型是决定性的.
多项式\[
f(x_1,x_2,x_3) = x_1^2 + 4 x_1 x_2 + 3 x_2^2 + 5 x_2 x_3 - x_3^2
\]和\[
g(x_1,x_2,x_3) = x_1^2 + 2\sqrt{2} x_1 x_2 + 2 x_1 x_3 + 2 x_2^2 + 4\sqrt{3} x_2 x_3
\]都是实数域上的二次型；
但在有理数域上，只有\(f\)是二次型，\(g\)不是二次型.

前面提到我们希望将一般方程化为标准方程，现在我们就要定义何种形式的方程应该被称为标准方程.
再次观察平面二次曲线的标准方程可以发现，标准方程的等号左边应该是二次齐次多项式（即若干个变量的平方和），等号右边则应该是任意（非零）常数.

\begin{definition}
若\(n\)阶对称矩阵\(\A = (a_{ij})_n\)满足
\begin{equation}\label{equation:二次型.二次型的矩阵表示}
f(\AutoTuple{x}{n}) = \x^T\A\x,
\end{equation}其中\(\x = (\AutoTuple{x}{n})^T\)，
则称\cref{equation:二次型.二次型的矩阵表示} 为二次型\(f(\AutoTuple{x}{n})\)的\DefineConcept{矩阵表示}，
对称矩阵\(\A\)为\(f\)的\DefineConcept{矩阵}，
\(\A\)的秩\(\rank\A\)为\(f\)的\DefineConcept{秩}.
\end{definition}

显然，对于任一\(n\)阶矩阵\(\B\)，\(\x^T\B\x\)必定是一个二次型.
需要注意的是，矩阵\(\B\)不必是对称矩阵，但“二次型\(\x^T\B\x\)的矩阵”必定是一个对称矩阵.

\begin{property}
二次型和它的矩阵是相互唯一确定的.
\begin{proof}
对于二次型\(f(\AutoTuple{x}{n})\)，设非零\(n\)阶对称矩阵\(\A\)和\(\B\)都是\(f\)的矩阵，即\[
\x^T\A\x
=\x^T\B\x
=f(\AutoTuple{x}{n}),
\]则二次型\(\x^T\A\x\)与\(\x^T\B\x\)中\(x_i x_j\)的系数\(2 a_{ij}\)与\(2 b_{ij}\)（\(1 \leq i < j \leq n\)）必相等，\(x_i^2\)的系数\(a_{ii}\)与\(b_{ii}\)（\(i=1,2,\dotsc,n\)）必相等，故\(\A=\B\).
\end{proof}
\end{property}

\begin{example}
将\(f(x_1,x_2,x_3) = x_1^2 + 4 x_1 x_2 + 3 x_2^2 + 5 x_2 x_3 - x_3^2\)写成矩阵形式.
\begin{solution}
\(f(x_1,x_2,x_3) = \begin{bmatrix}
x_1 & x_2 & x_3
\end{bmatrix} \begin{bmatrix}
1 & 2 & 0 \\
2 & 3 & \frac{5}{2} \\
0 & \frac{5}{2} & -1
\end{bmatrix} \begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}\).
\end{solution}
\end{example}

\begin{example}
写出二次型\(\begin{bmatrix}
x_1 & x_2 & x_3
\end{bmatrix} \begin{bmatrix}
2 & -3 & 1 \\
1 & 0 & 1 \\
2 & 11 & 3
\end{bmatrix} \begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}\)的矩阵.
\begin{solution}
注意到矩阵\(\A = \begin{bmatrix}
2 & -3 & 1 \\
1 & 0 & 1 \\
2 & 11 & 3
\end{bmatrix}\)不是对称矩阵，二次型\(\x^T\A\x\)的矩阵应为\[
\B = \frac{\A+\A^T}{2} = \begin{bmatrix}
2 & -1 & \frac{3}{2} \\
-1 & 0 & 6 \\
\frac{3}{2} & 6 & 3
\end{bmatrix}.
\]
\end{solution}
\end{example}

\subsection{线性替换}
\begin{definition}
因为平面二次曲线方程通过旋转变换化为标准方程，
实际上是用新变量的一次式代替原来的变量.
同样地，使用这种基本的方法来化简一般的\(n\)元二次型，
作如下的变量替换：\[
\left\{ \begin{array}{l}
x_1 = c_{11}y_1 + c_{12}y_2 + \dotsb + c_{1n}y_n \\
x_2 = c_{21}y_1 + c_{22}y_2 + \dotsb + c_{2n}y_n \\
\hdotsfor{1} \\
x_n = c_{n1}y_1 + c_{n2}y_2 + \dotsb + c_{nn}y_n
\end{array} \right.
\]写成矩阵形式\[
\begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix}
= \begin{bmatrix} c_{11} & c_{12} & \dots & c_{1n} \\
c_{21} & c_{22} & \dots & c_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
c_{n1} & c_{n2} & \dots & c_{nn}
\end{bmatrix}\begin{bmatrix}
y_1 \\ y_2 \\ \vdots \\ y_n
\end{bmatrix}
\quad\text{或}\quad
\x=\C\mat{Y}.
\]

上述变量之间的替换称为\DefineConcept{线性替换}.

当矩阵\(\C=(c_{ij})_n\)可逆时，
称为\DefineConcept{可逆线性替换}（或\DefineConcept{满秩的线性替换}，或\DefineConcept{非退化的线性替换}等）.
\end{definition}

\begin{theorem}
对二次型\(f(\AutoTuple{x}{n})=\x^T\A\x\)（\(\A=\A^T\)）作可逆线性替换\(\x=\C\y\)，则\(f\)化为新变量的二次型\(g(\AutoTuple{y}{n})=\y^T\B\y\)，其中\(\B=\C^T\A\C\)为\(g\)的矩阵.
\begin{proof}
\(f(\AutoTuple{x}{n}) = \x^T\A\x%
\xlongequal{\x=\C\y} (\C\y)^T\A(\C\y)%
= \y^T (\C^T\A\C) \y\)，
令\(\B = \C^T\A\C\)，由于\(\B^T = (\C^T\A\C)^T = \C^T\A\C = \B\)，以及\(\C\)可逆，所以\(\B\)是对称矩阵.
\(f\)是二次型，它的矩阵\(\A\neq\z\)，\(\B\cong\A\)，故\(\B\neq\z\).
于是，\(g(\AutoTuple{y}{n})=\y^T\B\y\)是二次型，对称矩阵\(\B\)是\(g\)的矩阵.
\end{proof}
\end{theorem}

\subsection{矩阵合同的概念}
\begin{definition}
设\(\A\)和\(\B\)是两个\(n\)阶矩阵，
若存在可逆矩阵\(\C\)，
使得\(\B=\C^T\A\C\)，
则称“\(\A\)与\(\B\) \DefineConcept{合同}（congruent）”%
或“\(\B\)是\(\A\)的\DefineConcept{合同矩阵}”，
记为\(\A\simeq\B\).
\end{definition}

\begin{property}
矩阵的合同关系是等价关系，即具备下列三条性质：
\begin{enumerate}
\item 反身性，\(\A\simeq\A\)；
\item 对称性，\(\A\simeq\B \implies \B\simeq\A\)；
\item 传递性，\(\A\simeq\B \land \B\simeq\C \implies \A\simeq\C\).
\end{enumerate}
\end{property}

\begin{property}
合同矩阵与原矩阵等价，即\(\A\simeq\B \implies \A\cong\B\).
\begin{proof}
由\hyperref[definition:逆矩阵.矩阵等价]{矩阵等价的定义}显然有.
\end{proof}
\end{property}

\begin{property}
合同矩阵的秩与原矩阵相等，即\(\A\simeq\B \implies \rank\A=\rank\B\).
\begin{proof}
由\cref{theorem:线性方程组.初等变换不变秩} 立得.
\end{proof}
\end{property}

\begin{property}
对称矩阵的合同矩阵也是对称的，即\(\A^T = \A, \A\simeq\B \implies \B^T = \B\).
\begin{proof}
设可逆矩阵\(\C\)满足\(\C^T\A\C=\B\)，那么%
\(\B^T = (\C^T\A\C)^T = \C^T\A^T\C = \C^T\A\C = \B\).
\end{proof}
\end{property}

\begin{property}
矩阵相似是矩阵合同的充分不必要条件，即\[
\A\sim\B
\implies
\A\cong\B.
\]
\end{property}

\begin{example}\label{example:二次型.实对称矩阵相似必合同}
实对称矩阵\(\A\)、\(\B\)相似，证明：\(\A\)与\(\B\)合同.
\begin{proof}
因为\(\A\)、\(\B\)都是实对称矩阵，\(\A^T=\A\)，\(\B^T=\B\)，且存在正交矩阵\(\Q_1,\Q_2\)使得\[
\Q_1^{-1} \A \Q_1 = \Q_1^T \A \Q_1 = \V_1,
\]\[
\Q_2^{-1} \B \Q_2 = \Q_2^T \B \Q_2 = \V_2,
\]其中\(\V_1,\V_2\)是对角阵.
又因为\(\A\sim\B\)，所以\(\A\)与\(\B\)有相同的特征多项式、特征值，即\(\V_1=\V_2\)，或\[
\Q_1^{-1} \A \Q_1 = \Q_2^{-1} \B \Q_2,
\]\[
(\Q_2 \Q_1^{-1}) \A (\Q_1 \Q_2^{-1}) = \B.
\]令\(\P = \Q_1 \Q_2^{-1}\)，\(\P^T = (\Q_1 \Q_2^{-1})^T = (\Q_2^{-1})^T \Q_1^T = \Q_2 \Q_1^{-1} = (\Q_1 \Q_2^{-1})^{-1} = \P^{-1}\)，那么\[
\P^T \A \P = \B,
\]也就是说\(\A\)与\(\B\)合同.
\end{proof}
\end{example}

\begin{example}
尽管在\cref{example:二次型.实对称矩阵相似必合同} 中我们看到“两个相似的实对称矩阵必定合同”，但两个合同的实对称矩阵未必相似，我们立即可以拿出一个反例：
\def\diagx(#1){\begin{bmatrix} #1 \\ & #1 \\ && #1 \end{bmatrix}}%
因为\[
\diagx(3^{-1/2})^T \diagx(3) \diagx(3^{-1/2}) = \diagx(1),
\]即\(\A = \diag(3,3,3) \cong \E\)，但\(\tr\A = 9 \neq \tr\E = 3\)，也就是说两个矩阵并不相似.
\end{example}

\begin{example}\label{example:二次型.合同矩阵符号相同}
设\(\A\)、\(\B\)、\(\C\)都是可逆矩阵，且满足\(\C^T\A\C=\B\)，
则\(\abs{\A}\)与\(\abs{\B}\)的符号相同.
\begin{proof}
因为\(\B=\C^T\A\C\)，
所以\(\A\B=\A\C^T\A\C\)，
进而有\[
\abs{\A}\abs{\B}
=\abs{\A\B}
=\abs{\A\C^T\A\C}
=\abs{\A}\abs{\C^T}\abs{\A}\abs{\C}
=\abs{\A}^2\abs{\C}^2.
\]
又因为\(\abs{\A} \neq 0\)，\(\abs{\A}^2 > 0\)，\(\abs{\C} \neq 0\)，\(\abs{\C}^2 > 0\)，所以\(\abs{\A}\abs{\B} > 0\)，即\(\abs{\A}\)与\(\abs{\B}\)同号.
\end{proof}
\end{example}
由\cref{example:二次型.合同矩阵符号相同} 可知，若矩阵\(\A,\B\)合同，则\(\sgn\abs{\A}=\sgn\abs{\B}\).

\begin{example}
设\(\AutoTuple{i}{n}\)是\(1,2,\dotsc,n\)的一个排列，
\[
\A=\diag(\AutoTuple{d}{n}),
\qquad
\B=\diag(d_{i_1},d_{i_2},\dotsc,d_{i_n}).
\]
证明：矩阵\(\A,\B\)合同且相似.
\begin{proof}
显然\(\diag(d_{i_1},d_{i_2},\dotsc,d_{i_n})\)可由\(\diag(\AutoTuple{d}{n})\)同时左乘和右乘若干个初等矩阵\[
\P(i,j) \quad(1 \leq i < j \leq n)
\]得到，又因为\(\P(i,j)^T = \P(i,j)^{-1} = \P(i,j)\)，所以只要令这些初等矩阵的乘积为\(\P\)，就有\[
\P^{-1} \A \P = \B,
\qquad
\P^T \A \P = \B.
\]也就是说\(\A\simeq\B\land\A\sim\B\).
\end{proof}
\end{example}

根据\cref{theorem:特征值与特征向量.实对称矩阵3}，任一实对称矩阵都与某个对角阵合同且相似，实际上，我们可以把这个结论推广到复数域上的对称矩阵.
\begin{theorem}
任一对称矩阵都合同于某个对角矩阵.
\end{theorem}

\section{二次型化为标准型的三种方法}
二次型的基本问题是研究如何通过非退化的线性替换将一个热词性化简为平方和的形式，从而讨论其性质.
\begin{definition}
如果二次型\(f(\AutoTuple{x}{n})=\x^T\A\x\)可以经过非退化的线性替换\(\x=\C\mat{Y}\)化简为\[
d_1 y_1^2 + d_2 y_2^2 + \dotsb + d_n y_n^2
\]的形式，则称上式为二次型\(f\)的\DefineConcept{标准型}或\DefineConcept{规范型}（standard form）.
\end{definition}
将二次型化为标准型的问题可以归结为对称矩阵合同于对角阵的问题.
下面介绍三种化二次型为标准型的方法.

\subsection{正交变换法}
根据\cref{theorem:特征值与特征向量.实对称矩阵3}，对于任何一个实对称矩阵\(\A\)，存在正交矩阵\(\Q\)，使得\[
\Q^{-1}\A\Q = \Q^T\A\Q = \diag(\AutoTuple{\lambda}{n}),
\]即实对称矩阵\(\A\)与对角阵\(\diag(\AutoTuple{\lambda}{n})\)合同且相似.

\begin{theorem}
对于任一\(n\)元实二次型\(f(\AutoTuple{x}{n})=\x^T\A\x\)（\(\A=\A^T\)），都存在正交矩阵\(\Q\)，由\(\Q\)构成的线性替换\(\x=\Q\mat{Y}\)（称为\DefineConcept{正交变换}，{\rm orthogonal operator}）将\(f\)化为标准型\[
f(\AutoTuple{x}{n})
\xlongequal{\x=\Q\mat{Y}}
\lambda_1y_1^2+\lambda_2y_2^2+ \dotsb +\lambda_ny_n^2
\]其中\(\lambda_1,\lambda_2,\dotsc,\lambda_n\)是\(\A\)的全部特征值.
\end{theorem}

\begin{corollary}
正交变换的特点之一是保持向量的内积不变，也就是保持向量的长度不变，保持图形的形状不变.
\begin{proof}
设\(\Q\)为正交矩阵.
令\(\x_1=\Q\mat{Y}_1\)，
\(\x_2=\Q\mat{Y}_2\)，
必有\begin{align*}
\vectorinnerproduct{\x_1}{\x_2}
&=\vectorinnerproduct{(\Q\mat{Y}_1)}{(\Q\mat{Y}_2)}
=(\Q\mat{Y}_1)^T (\Q\mat{Y}_2)
=\mat{Y}_1^T \Q^T \Q \mat{Y}_2 \\
&=\mat{Y}_1^T \E \mat{Y}_2
=\mat{Y}_1^T \mat{Y}_2
=\vectorinnerproduct{\mat{Y}_1}{\mat{Y}_2},
\end{align*}
又令\(\x_1=\x_2=\x\)，
\(\mat{Y}_1=\mat{Y}_2=\mat{Y}\)，
则\(\abs{\x}^2=\abs{\mat{Y}}^2\)，
\(\abs{\x}=\abs{\mat{Y}}\).
\end{proof}
\end{corollary}

\begingroup
\color{red}
用正交变换法将二次型化为标准型的步骤如下：
\begin{enumerate}
\item 首先根据\(f\)的表达式写出\(f\)的矩阵\(\A\)；
\item 写出\(f\)矩阵的特征多项式\(\abs{\lambda\E-\A}=0\)，求解\(\A\)的特征值\(\AutoTuple{\lambda}{n}\)以及对应的特征向量\(\AutoTuple{\x}{n}\)；
\item 运用施密特规范化方法将\(\A\)的特征向量正交单位化为\(\AutoTuple{\g}{n}\)，然后写成正交矩阵\(\Q=(\AutoTuple{\g}{n})\)；
\item 计算得出标准型的矩阵\(\B=\Q^T\A\Q=\Q^{-1}\A\Q=\diag(\AutoTuple{\lambda}{n})\).
\end{enumerate}
\endgroup

\begin{example}
设\(f(x_1,x_2,x_3) = -x_1^2-x_2^2-7x_3^2-4x_1x_2+8x_1x_3+8x_2x_3\).
利用正交变换将\(f\)化为标准型，并写出所用的正交变换.
\begin{solution}
\def\z{\mat{Z}}%
\(f\)的矩阵为\[
\A = \begin{bmatrix}
-1 & -2 & 4 \\
-2 & -1 & 4 \\
4 & 4 & -7
\end{bmatrix}.
\]令\[
\abs{\l\E-\A} = \begin{bmatrix}
\l+1 & 2 & -4 \\
2 & \l+1 & -4 \\
-4 & -4 & \l+7
\end{bmatrix} = (\l-1)^2 (\l+11) = 0,
\]解得特征值\(\L1=1\)（二重），\(\L2=-11\).

当\(\l=1\)时，解方程\((\E-\A)\x=\z\)，\[
\E-\A = \begin{bmatrix}
2 & 2 & -4 \\
2 & 2 & -4 \\
-4 & -4 & 8
\end{bmatrix} \to \begin{bmatrix}
2 & 2 & -4 \\
0 & 0 & 0 \\
0 & 0 & 0
\end{bmatrix},
\]基础解系为\[
\X1 = \begin{bmatrix} -1 \\ 1 \\ 0 \end{bmatrix}, \qquad
\X2 = \begin{bmatrix} 2 \\ 0 \\ 1 \end{bmatrix}.
\]利用施密特方法将其正交化，得\[
\y_1=\X1,\qquad
\y_2=\X2-\frac{\X2\cdot\y_1}{\y_1\cdot\y_1}\y_1=\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix};
\]再将其单位化，得\[
\z_1=\frac{1}{\sqrt{2}} \begin{bmatrix} -1 \\ 1 \\ 0 \end{bmatrix}, \qquad
\z_2=\frac{1}{\sqrt{3}} \begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}.
\]

当\(\l=-11\)时，解方程\((-11\E-\A)\x=\z\)，\[
-11\E-\A = \begin{bmatrix}
-10 & 2 & -4 \\
2 & -10 & -4 \\
-4 & -4 & -4
\end{bmatrix} \to \begin{bmatrix}
1 & 1 & 1 \\
0 & 2 & 1 \\
0 & 0 & 0
\end{bmatrix},
\]基础解系为\[
\X3 = \begin{bmatrix} 1 \\ 1 \\ -2 \end{bmatrix},
\]单位化得\[
\z_3 = \frac{1}{\sqrt{6}} \begin{bmatrix} 1 \\ 1 \\ -2 \end{bmatrix}.
\]

令\[
\Q = (\z_1,\z_2,\z_3) = \begin{bmatrix}
-\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{6}} \\
\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{6}} \\
0 & \frac{1}{\sqrt{3}} & -\frac{2}{\sqrt{6}} \\
\end{bmatrix},
\]\(\Q\)是正交矩阵，满足\(\Q^T\A\Q=\Q^{-1}\A\Q=\diag(1,1,-11)\).
作正交变换\(\x=\Q\y\)，于是\(f\)化为标准型\(y_1^2+y_2^2-11y_3^2\).
\end{solution}
\end{example}

\begin{example}
设实二次型\[
f(\AutoTuple{x}{n})=\x^T\A\x
\]的矩阵\(\A\)的特征值为\(\AutoTuple{\lambda}{n}\)，\(c=\max\{\AutoTuple{\lambda}{n}\}\).
证明：对于任意\(n\)维实向量\(\x\)，都有\[
f(\AutoTuple{x}{n}) \leq c \x^T\x.
\]
\begin{proof}
因为\(\A\)是实对称矩阵，即存在正交矩阵\(\Q\)使得\(\Q^T\A\Q = \diag(\AutoTuple{\lambda}{n})\)，作正交变换\(\x=\Q\y\)，则\(f\)化为标准型\begin{align*}
f(\AutoTuple{x}{n}) &= \L{1} y_1^2 + \L{2} y_2^2 + \dotsb + \L{n} y_n^2 \\
&\leq c y_1^2 + c y_2^2 + \dotsb + c y_n^2
= c \y^T \y = c \x^T \x.
\qedhere
\end{align*}
\end{proof}
\end{example}

\subsection{拉格朗日配方法}
用正交变换能够化实二次型为标准型，这种方法是根据实对称矩阵的性质，求出二次型矩阵的特征值和规范正交的特征向量，条件要求较强.
当研究一般数域\(P\)上的二次型（包括实二次型）的标准型时，可以用\DefineConcept{拉格朗日配方法}.
这种方法不用解矩阵特征值问题，只需反复利用以下两个初等代数公式\[
a^2+2ab+b^2=(a+b)^2 ,\quad a^2-b^2=(a+b)(a-b)
\]就能将二次型化为标准型.

\begin{example}
用配方法化二次型\(f(x_1,x_2,x_3)
= x_1^2 + 2 x_1 x_2 + 2 x_2^2 - 3 x_2 x_3\)为标准型，并求出所用的可逆线性替换.
\begin{solution}
首先有
\begin{align*}
f(x_1,x_2,x_3)
&= x_1^2 + 2 x_1 x_2 + 2 x_2^2 - 3 x_2 x_3 \\
&= x_1^2 + 2 x_1 x_2 + x_2^2 + x_2^2 - 3 x_2 x_3 \\
&= (x_1 + x_2)^2 + x_2^2 - 3 x_2 x_3 + \frac{9}{4} x_3^2 - \frac{9}{4} x_3^2 \\
&= (x_1 + x_2)^2 + \left( x_2 - \frac{3}{2} x_3 \right)^2 - \frac{9}{4} x_3^2,
\end{align*}
令\[
\left\{ \def\arraystretch{1.5} \begin{array}{*7r}
y_1 &= &x_1 &+&x_2 \\
y_2 &= & & & x_2 & -& \frac{3}{2} x_3 \\
y_3 &= & & & & & x_3
\end{array} \right.
\eqno{(1)}
\]则\[
\left\{ \def\arraystretch{1.5} \begin{array}{*7r}
x_1 &= &y_1 &-&y_2 &-&\frac{3}{2} y_3 \\
x_2 &= & & & y_2 & +& \frac{3}{2} y_3 \\
x_3 &= & & & & & y_3
\end{array} \right.
\eqno{(2)}
\]
(2)是可逆线性替换，使\(f(x_1,x_2,x_3) = y_1^2 + y_2^2 - \frac{9}{4} y_3^2\).
\end{solution}
\end{example}

\begin{theorem}
对于任一\(n\)元二次型\(f(\AutoTuple{x}{n})=\x^T\A\x\ (\A=\A^T)\)，都存在非退化的线性替换\(\x=\C\mat{Y}\)，使之成为\[
f(\AutoTuple{x}{n})=d_1 y_1^2 + d_2 y_2^2 + \dotsb + d_n y_n^2.
\]
\begin{proof}
应用数学归纳法.
当\(n=1\)时，\(f(x_1) = a_{11} x_1^2 = d_1 y_1^2\)，结论成立.

假设当\(n=k-1\ (k\geq2)\)时结论成立；那么当\(n=k\)时，我们分以下两种情况进行讨论：
\begin{enumerate}
\item 若\(f\)的平方项系数不全为零，不妨设\(a_{11}\neq0\)，
从而有\begin{align*}
	f(\AutoTuple{x}{n})
	&= a_{11} x_1^2 + 2 x_1 \sum\limits_{j=2}^n a_{1j} x_j
		+ \sum\limits_{i=2}^n \sum\limits_{j=2}^n a_{ij} x_i x_j \\
	&= a_{11} \left[
		x_1 + \frac{1}{a_{11}} \sum\limits_{j=2}^n a_{1j} x_j
	\right]^2
	- \frac{1}{a_{11}} \left[
		\sum\limits_{j=2}^n a_{1j} x_j
	\right]^2
	+ \sum\limits_{i=2}^n \sum\limits_{j=2}^n a_{ij} x_i x_j,
\end{align*}
令\[
	y_1 = x_1 + \frac{1}{a_{11}} \sum\limits_{j=2}^n a_{1j} x_j, \qquad
	y_2 = x_2, \qquad
	\dotsc, \qquad
	y_n = x_n,
\]
则\[
	f(\AutoTuple{x}{n}) = a_{11} y_1^2 + g(\AutoTuple{y}[2]{n}),
\]
其中\(g(\AutoTuple{y}[2]{n})
= - \frac{1}{a_{11}} \left[
	\sum\limits_{j=2}^n a_{1j} x_j
\right]^2
+ \sum\limits_{i=2}^n \sum\limits_{j=2}^n a_{ij} x_i x_j\)%
是一个\(n-1\)元二次型或零多项式.
由归纳假设，存在\(n-1\)阶可逆矩阵\(\Q\)，
得到非退化线性变换\((\AutoTuple{y}[2]{n})^T = \Q (\AutoTuple{z}[2]{n})^T\)，
使得\[
	g(\AutoTuple{y}[2]{n})
	= d_2 z_2^2 + d_3 z_3^2 + \dotsb + d_n z_n^2.
\]
记\[
\P = \begin{bmatrix}
1 & -a_{11}^{-1} a_{12} & -a_{11}^{-1} a_{13} & \dots & -a_{11}^{-1} a_{1n} \\
& 1 & 0 & \dots & 0 \\
& & 1 & \dots & 0 \\
& & & \ddots & \vdots \\
& & & & 1
\end{bmatrix},
\]则非退化线性替换\[
\begin{bmatrix}
x_1 \\ x_2 \\ \vdots \\ x_n
\end{bmatrix}
= \P \begin{bmatrix}
y_1 \\ y_2 \\ \vdots \\ y_n
\end{bmatrix}
= \P \begin{bmatrix} 1 & \z \\ \z & \Q \end{bmatrix} \begin{bmatrix}
z_1 \\ z_2 \\ \vdots \\ z_n
\end{bmatrix}
\]使得\(f(\AutoTuple{x}{n}) = a_{11} z_1^2 + d_2 z_2^2 + d_3 z_3^2 + \dotsb + d_n z_n^2\).

\item 若\(f\)不含平方项，则必存在\(1 \leq i < j \leq n\)使得\(a_{ij}\neq0\)；
于是\[
\left\{ \begin{array}{l}
x_i = y_i + y_j \\
x_j = y_i - y_j \\
x_k = y_k\ (1 \leq k \leq n \land k \neq i \land k \neq j)
\end{array} \right.
\]是非退化的线性替换，使得\[
f(\AutoTuple{x}{n})
= g(\AutoTuple{y}{n})
= a_{ij} y_i^2 - a_{ij} y_j^2 + h(\AutoTuple{y}{n}),
\]其中\(h(\AutoTuple{y}{n})\)是不含平方项的二次型或零多项式，故\(g(\AutoTuple{y}{n})\)含有平方项，这归结为第一种情形，从而可以化为标准型.
\qedhere
\end{enumerate}
\end{proof}
\end{theorem}

\begin{corollary}
任意\(n\)阶对称矩阵\(\A\)都与对角形矩阵合同.
\end{corollary}

\subsection{初等变换法}
\begin{definition}
设\(\P\)为初等矩阵.
对于任意矩阵\(\B\)，称变换\(\B \to \P^T\B\P\)为对\(\B\)作一次\DefineConcept{合同变换}.
\end{definition}

\begin{theorem}
因为对于任一对称阵\(\A\)，存在可逆矩阵\(\C\)，使得\[
\C^T\A\C=\diag(\AutoTuple{d}{n}).
\]
又因为存在初等矩阵\(\P_1,\P_2,\dotsc,\P_m\)，使得\[
\C=\P_1\P_2\dotsm\P_m,
\]那么\[
\C^T\A\C = (\P_m^T\P_{m-1}^T\dotsm\P_1^T)\A(\P_1\P_2\dotsm\P_m)=\diag(\AutoTuple{d}{n}).
\]

因为初等矩阵有三类：
\begin{enumerate}
\item \(\P(i,j)^T\B\P(i,j)=\P(i,j)\B\P(i,j)\)，相当于交换\(\B\)的\(i,j\)两行，再交换\(\P(i,j)\B\)的\(i,j\)两列.
\item \(\P(i(c))^T\B\P(i(c))=\P(i(c))\B\P(i(c))\)（\(c \neq 0\)），相当于用\(c\)乘\(\B\)的\(i\)行，再用\(c\)乘\(\P(i(c))\B\)的\(i\)列.
\item \(\P(i,j(k))^T\B\P(i,j(k))=\P(j,i(k))\B\P(i,j(k))\)，相当于将\(\B\)的\(i\)行的\(k\)倍加到\(j\)行，再将\(\P(j,i(k))\B\)的\(i\)列的\(k\)倍加到\(j\)列.
\end{enumerate}
可见，对称矩阵\(\A\)可以经过一系列合同变换化为对角形矩阵.
则\[
\begin{bmatrix} \A \\ \E \end{bmatrix}
\to
\begin{bmatrix} \C^T & \z \\ \z & \E \end{bmatrix}
\begin{bmatrix} \A \\ \E \end{bmatrix}
\C = \begin{bmatrix} \C^T\A\C \\ \C \end{bmatrix},
\]\[
(\A,\E)
\to
\C^T (\A,\E) \begin{bmatrix}
\C & \z \\
\z & \E
\end{bmatrix}
= (\C^T\A\C,\C^T).
\]其中\(\C=\P_1\P_2\dotsm\P_m\)，
即对\(\A\)作一系列合同变换化为对角阵\(\C^T\A\C\)，只对\(\E\)进行列变换，将\(\E\)变成\(\C\)；或者只对\(\E\)作其中的行变换，则将\(\E\)变为\(\C^T\).
\end{theorem}

\section{实二次型的分类}
\subsection{实二次型的分类标准}
\begin{definition}
设有\(n\)元实二次型\(f(\AutoTuple{x}{n}) = \x^T\A\x\)，如果对任意一组不全为零的实数\(\AutoTuple{c}{n}\)，都有
\begin{enumerate}
	\item \(f(\AutoTuple{c}{n}) > 0\)，
	则称“\(f\)是\DefineConcept{正定的}（positive definite）”；
	把\(\A\)称为\DefineConcept{正定矩阵}（positive definite matrix），
	记为\(\A\succ\z\).

	\item \(f(\AutoTuple{c}{n}) \geq 0\)，
	则称“\(f\)是\DefineConcept{半正定的}（positive semi-definite）”；
	把\(\A\)称为\DefineConcept{半正定矩阵}（positive semi-definite matrix），
	记为\(\A\succeq\z\).

	\item \(f(\AutoTuple{c}{n}) < 0\)，
	则称“\(f\)是\DefineConcept{负定的}（negative definite）”，
	把\(\A\)称为\DefineConcept{负定矩阵}（negative definite matrix），
	记为\(\A\prec\z\).

	\item \(f(\AutoTuple{c}{n}) \leq 0\)，
	则称“\(f\)是\DefineConcept{半负定的}（negative semi-definite）”；
	把\(\A\)称为\DefineConcept{半负定矩阵}（negative semi-definite matrix），
	记为\(\A\preceq\z\).

	\item 否则（\(f\)既可取正值，又可取负值），
	称\(f\)是\DefineConcept{不定的}（indefinite）.
\end{enumerate}
\end{definition}

\subsection{惯性定理}
\begin{theorem}\label{theorem:二次型.惯性定理}
\(n\)元实二次型\[
f(\AutoTuple{x}{n}) = \x^T\A\x
\]经过任意满秩线性变换化为标准型，所得的标准型的正平方项的项数\(p\)及负平方项的项数\(q\)都是唯一确定的.
\begin{proof}
\def\z{\mat{Z}}%
设实二次型的秩为\(r\).
假设\(f\)经过两个不同的可逆线性替换\(\x=\C\y,\x=\D\z\)分别化为标准型\[
f \xlongequal{\x=\C\y} c_1 y_1^2 + c_2 y_2^2 + \dotsb + c_p y_p^2 - c_{p+1} y_{p+1}^2 - \dotsb - c_r y_r^2,
\eqno{(1)}
\]\[
f \xlongequal{\x=\D\z} d_1 z_1^2 + d_2 z_2^2 + \dotsb + d_q z_q^2 - d_{q+1} z_{q+1}^2 - \dotsb - d_r z_r^2,
\eqno{(2)}
\]其中\(c_i,d_i>0\ (i=1,2,\dotsc,r)\).

用反证法.
设\(p > q\)，由\(\x = \C\y = \D\z\)，\(\D\)可逆，得\(\z = \D^{-1} \C \y\).
\def\H{\mat{H}}%
\def\zexpr#1{h_{#1 1} y_1 + h_{#1 2} y_2 + \dotsb + h_{#1 n} y_n}%
记\(\H = (h_{ij})_n = \B^{-1} \C\)，则\(\z = \H\y\)，即\[
z_i = \zexpr{i}
\quad(i=1,2,\dotsc,n).
\]于是\[\begin{aligned}
&\hspace{-20pt}
c_1 y_1^2 + c_2 y_2^2 + \dotsb + c_p y_p^2 - c_{p+1} y_{p+1}^2 - \dotsb - c_r y_r^2 \\
&= d_1 (\zexpr{1})^2 + d_2 (\zexpr{2})^2 \\
&\hspace{20pt}+ \dotsb + d_q (\zexpr{q})^2 \\
&\hspace{20pt}- d_{q+1} (\zexpr{q+1})^2 - \dotsb \\
&\hspace{20pt}- d_r (\zexpr{r})^2.
\end{aligned}
\eqno{(3)}
\]由此可以构造齐次线性方程组\[
\begin{cases}
\zexpr{1} = 0, \\
\hdotsfor{1} \\
\zexpr{q} = 0, \\
y_{p+1} = 0, \\
\hdotsfor{1} \\
y_n = 0.
\end{cases}
\eqno{(4)}
\]这个方程组中有\(n\)个未知量，\(q+n-p < n\)个方程，于是它有非零解\((\AutoTuple{y}{p},0,\dotsc,0)^T\)，
代入(3)式两端，得到左边大于零，右边小于等于零，矛盾，因此\(p \leq q\).
同理又有\(q \leq p\)，于是\(p = q\).
\end{proof}
\end{theorem}
\cref{theorem:二次型.惯性定理}
又称为“惯性定理（Inertial Theorem）”.

\begin{corollary}
任意\(n\)元实二次型\(f(\AutoTuple{x}{n}) = \x^T\A\x\)，总可经过满秩线性变换化为以下形式的标准型\[
f(\AutoTuple{x}{n})
=y_1^2+y_2^2+ \dotsb +y_p^2
-y_{p+1}^2-\dotsb-y_r^2
\]称为\(f(\AutoTuple{x}{n})\)的\DefineConcept{规范型}（{\rm normal form}），且规范型是唯一的.
\begin{proof}
根据惯性定理，\(f\)经过可逆线性替换化为标准型：\[
f \xlongequal{\x=\D\z} d_1 z_1^2 + d_2 z_2^2 + \dotsb + d_q z_q^2 - d_{q+1} z_{q+1}^2 - \dotsb - d_r z_r^2,
\]其中\(d_i>0\ (i=1,2,\dotsc,r)\).
令\[
\C = \D \diag(d_1^{-1/2},\dotsc,d_r^{-1/2},1,\dotsc,1),
\]则\(\x = \D\z = \C\y\)是可逆线性替换，使得\[
f \xlongequal{\x=\D\z} y_1^2 + y_2^2 + \dotsb + y_q^2 - y_{q+1}^2 - \dotsb - y_r^2.
\]二次型的规范型的唯一性可以由惯性定理得到.
\end{proof}
\end{corollary}

\begin{definition}
在秩为\(r\)的实二次型\(f(\AutoTuple{x}{n})\)所化成的标准型（或规范型）中，正平方项的项数\(p\)称为\(f\)的\DefineConcept{正惯性指数}（positive index of inertia），负平方项的项数\(q=r-p\)称为\(f\)的\DefineConcept{负惯性指数}（minus index of inertia），正、负惯性指数之差\(d=p-q=2p-r\)称为\(f\)的\DefineConcept{符号差}（signature）.
\end{definition}
由惯性定理和以上定义可知：可逆线性替换不改变二次型的正、负惯性指数.从而可由二次型的正、负惯性指数确定二次型的类型.

\begin{theorem}
设\(\A\)和\(\B\)是同阶实对称矩阵.这两个矩阵合同的充要条件是两者的秩、正负惯性指数均相等，即\[
\A\simeq\B \iff \rank\A=\rank\B, p_{\A}=p_{\B}, q_{\A}=q_{\B}.
\]
\end{theorem}

\subsection{正定矩阵的等价条件}
\begin{theorem}
设\(\A\)为\(n\)阶实对称矩阵，\(f(\AutoTuple{x}{n}) = \x^T\A\x\)，则下列命题相互等价：
\begin{enumerate}
\item \(\A\)为正定矩阵；
\item \(\A\)的特征值全是正实数；
\item \(f(\AutoTuple{x}{n})\)的正惯性指数\(p=n\)；
\item \(\A \cong \E\)（即，存在可逆实阵\(\C\)，使得\(\C^T\A\C=\E\)）；
\item 存在可逆实阵\(\P\)，使得\(\A=\P^T\P\).
\end{enumerate}
\end{theorem}

\begin{corollary}
正定矩阵的行列式大于零.
\begin{proof}
因为\(\A\)正定，所以存在可逆实阵\(\P\)，使得\(\A=\P^T\P\)，则\(\abs{\A}=\abs{\P^T\P}=\abs{\P^T}\abs{\P}=\abs{\P}^2>0\).
\end{proof}
\end{corollary}

\begin{theorem}
\(n\)元实二次型\(f(\AutoTuple{x}{n}) = \x^T\A\x\)（\(\A=\A^T\)）正定的充要条件是：\(\A\)的各阶顺序主子式均大于零.
\begin{proof}
必要性.对于任意不全为零的\(n\)个实数\(c_1,c_2,\dotsc,c_k,0,\dotsc,0\)，总有\[
f(c_1,c_2,\dotsc,c_k,0,\dotsc,0) = \sum\limits_{i=1}^k \sum\limits_{j=1}^k c_i c_j a_{ij} > 0,
\]从而\(k\)元实二次型\(f_k(x_1,x_2,\dotsc,x_k) = \sum\limits_{i=1}^k \sum\limits_{j=1}^k x_i x_j a_{ij}\)正定，而\(f_k\)的矩阵为\(\A_k = (a_{ij})_k\)，那么\(\abs{\A_k} > 0\)（\(k=1,2,\dotsc,n\)）.

充分性.当\(n=1\)时，\(a_{11} > 0\)，\(f_1(x_1) = a_{11} x_1^2\)正定.
设\(n=k-1\)时结论成立，当\(n=k\)时，将\(\A\)分块得\(\A = \begin{bmatrix}
\A_{k-1} & \a \\
\a^T & a_{nn}
\end{bmatrix}\)，其中\(\A_{k-1}\)为各阶顺序主子式都大于零的\(k-1\)阶实对称矩阵.
由归纳假设，\(\A_{k-1}\)正定，故存在\(k-1\)阶可逆矩阵\(\Q\)，使得\(\A_{k-1} = \Q^T \Q\)，\(\A_{k-1}\)可逆，\(\A_{k-1}^{-1} = \Q^{-1}(\Q^{-1})^T\)是对称矩阵.
令\(\P = \begin{bmatrix}
\Q^{-1} & -\A_{k-1}^{-1} \a \\
\z & 1
\end{bmatrix}\)，则\(\P\)可逆，于是\begin{align*}
\P^T \A \P &= \begin{bmatrix}
(\Q^{-1})^T & \z \\
-\a^T \A_{k-1}^{-1} & 1
\end{bmatrix} \begin{bmatrix}
\Q^T \Q & \a \\
\a^T & a_{nn}
\end{bmatrix} \begin{bmatrix}
\Q^{-1} & -\A_{k-1}^{-1} \a \\
\z & 1
\end{bmatrix} \\
&= \begin{bmatrix}
\Q & (\Q^{-1})^T \a \\
\z & b
\end{bmatrix} \begin{bmatrix}
\Q^{-1} & -\A_{k-1}^{-1} \a \\
\z & 1
\end{bmatrix}
= \begin{bmatrix}
\E_{k-1} & \z \\
\z & b
\end{bmatrix} = \B,
\end{align*}
其中\(b=a_{nn}-\a^T \A_{k-1}^{-1} \a\).
由于\(\A\)与\(\B\)合同，\(\abs{\A} > 0\)，得\(\abs{\B} = b > 0\)，作可逆线性替换\(\x = \P\y\)，则\[
f \xlongequal{\x=\Q\y} y_1^2 + y_2^2 + \dotsb + y_{n-1}^2 + b y_n^2,
\]故\(f\)的正惯性指数为\(n\)，\(f\)正定.
\end{proof}
\end{theorem}

\begin{corollary}
\(n\)元实二次型\(f(\AutoTuple{x}{n}) = \x^T\A\x\)（\(\A=\A^T\)）负定的充要条件是：\[
(-1)^k D_k = (-1)^k \begin{vmatrix}
a_{11} & a_{12} & \dots & a_{1k} \\
a_{21} & a_{22} & \dots & a_{2k} \\
\vdots & \vdots & \ddots & \vdots \\
a_{k1} & a_{k2} & \dots & a_{kk}
\end{vmatrix} > 0,
\quad k=1,2,\dotsc,n.
\]
\end{corollary}

\begin{example}
设\(\A\)为实对称矩阵，证明：当实数\(t\)充分大时，\(t\E+\A\)是正定矩阵.
\begin{proof}
因为\(\A\)为实对称矩阵，所以存在正交矩阵\(\Q\)，使得\[
\Q^T\A\Q = \diag(\AutoTuple{\lambda}{n}).
\]又因为\[
\Q^T(t\E+\A)\Q
= \diag(t+\L{1},t+\L{2},\dotsc,t+\L{n}),
\]所以当\(t+\L{1},t+\L{2},\dotsc,t+\L{n}\)都大于零时，\(t\E+\A\)正定.
\end{proof}
\end{example}

\begin{example}
设\(\A\)、\(\B\)是同阶正定矩阵，证明：\(\A+\B\)、\(\A^{-1}\)、\(\A^*\)是正定矩阵.
\begin{proof}
根据正定矩阵的定义，因为\(\A\)是正定矩阵，任取非零列向量\(\x\)，都有\[
\x^T\A\x > 0;
\]同样地，有\(\x^T\B\x > 0\).

又根据矩阵的乘法分配律，有\[
\x^T(\A+\B)\x = \x^T\A\x + \x^T\B\x > 0
\]成立，即\(\A+\B\)是正定矩阵.

因为\(\A\)是正定矩阵，存在可逆实阵\(\P\)使得\(\P^T\A\P=\E\)，所以\[
\A = (\P^T)^{-1}\E\P^{-1} = (\P^T)^{-1}\P^{-1}
\implies
\A^{-1} = \P\P^T,
\]说明\(\A^{-1}\)是正定矩阵.

由逆矩阵的定义，\(\A^{-1}=\frac{1}{\abs{\A}}\A^*\)，那么\(\A^*=\abs{\A}\A^{-1}\)，\(\abs{\A}>0\)，显然\(\A^*\)也是正定矩阵.
\end{proof}
\end{example}

\begin{example}
设\(\A\)是正定矩阵，试证：存在正定矩阵\(\B\)，使得\(\A=\B^2\).
\begin{proof}
设\(\A\)是\(n\)阶正定矩阵，那么存在正交矩阵\(\P\)满足\[
\P^T\A\P = \diag(\AutoTuple{\lambda}{n}) = \V,
\]其中\(\AutoTuple{\lambda}{n} \in \mathbb{R}^+\).
又设矩阵\(\B\)满足\(\B^2=\A\)，那么\[
\P^T\A\P = \P^T\B^2\P = \V
\iff
\B^2 = \P\V\P^T,
\]
只需要令\(\B = \P \diag(\sqrt{\L{1}},\sqrt{\L{2}},\dotsc,\sqrt{\L{n}}) \P^T\)即可.
\end{proof}
\end{example}

\section{二次型的应用}
\subsection{二次型在解析几何中的应用}
下面利用矩阵的运算及二次型理论讨论平面二次曲线、空间二次曲面的分类问题.
