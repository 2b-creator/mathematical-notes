\section{矩阵的秩}
\subsection{矩阵的秩的概念与性质}
为了求解向量组的秩，我们可以把向量组看成矩阵的行向量组或列向量组，
利用矩阵的性质，得出这个矩阵的行向量组、列向量组的秩.

\begin{definition}\label{definition:线性方程组.行秩与列秩的定义}
设\(\A\)是向量.
\begin{enumerate}
	\item \(\A\)的行向量组生成的子空间称为“\(\A\)的\DefineConcept{行空间}（row space）”.
	\item \(\A\)的列向量组生成的子空间称为“\(\A\)的\DefineConcept{列空间}（column space）”.
	\item \(\A\)的行向量组的秩称为“\(\A\)的\DefineConcept{行秩}（row rank）”，记为\(\rank_R A\).
	\item \(\A\)的列向量组的秩称为“\(\A\)的\DefineConcept{列秩}（column rank）”，记为\(\rank_C A\).
\end{enumerate}
%@see: https://mathworld.wolfram.com/RowSpace.html
%@see: https://mathworld.wolfram.com/ColumnSpace.html
\end{definition}

矩阵的列秩等于它的列空间的维数，它的行秩等于它的行空间的维数.

\begin{definition}\label{definition:线性方程组.矩阵的秩的定义}
\(\A\)的非零子式的最高阶数\(r\)称为
“矩阵\(\A\)的\DefineConcept{秩}（rank）\footnote{
这种定义方式最早是由西尔维斯特于1851年给出的.}”，
记为\(\rank\A\).
%@see: https://mathworld.wolfram.com/MatrixRank.html
\end{definition}

\begin{property}\label{theorem:线性方程组.矩阵的秩的性质1}
零矩阵的秩为零，即\(\rank\z = 0\).
\end{property}

\begin{property}\label{theorem:线性方程组.矩阵的秩的性质2}
设\(\A\)是\(s \times n\)矩阵，则\[
	0 \leqslant \rank\A = \rank\A^T \leqslant \min\{s,n\}.
\]
\end{property}

\begin{property}\label{theorem:线性方程组.矩阵的秩的性质3}
设\(s \times n\)矩阵\(\A\)的秩为\(\rank\A = r < \min\{s,n\}\)，
那么对于\(\forall m > r\)，
总有\(m\)阶子式全为零，即\[
	\A\begin{pmatrix}
		\AutoTuple{i}{m} \\
		\AutoTuple{j}{m}
	\end{pmatrix} = 0,
	\quad
	\begin{array}{c}
		1 \leqslant i_1 < i_2 < \dotsb < i_m \leqslant s; \\
		1 \leqslant j_1 < j_2 < \dotsb < j_m \leqslant n.
	\end{array}
\]
\end{property}

\begin{definition}
设矩阵\(\A = (a_{ij})_{s \times n}\).
\begin{enumerate}
	\item 若\(\rank\A = s\)，
	则称“\(\A\)为\DefineConcept{行满秩矩阵}（row full rank matrix）”.
	\item 若\(\rank\A = n\)，
	则称“\(\A\)为\DefineConcept{列满秩矩阵}（column full rank matrix）”.
	\item 若\(\rank\A = s = n\)，
	则称“\(\A\)是\DefineConcept{满秩矩阵}（full rank matrix）”，
	或“\(\A\)是\DefineConcept{非退化矩阵}（non-degenerate matrix）”.
\end{enumerate}
\end{definition}

应该注意到，“可逆矩阵”“非奇异矩阵”“满秩矩阵”“非退化矩阵”是从不同侧重点对同一类矩阵的四种称谓.

\begin{property}\label{theorem:线性方程组.矩阵的秩的性质4}
矩阵\(\A\)是满秩矩阵的充要条件是\(\abs{\A}\neq0\).
\end{property}

\begin{example}
求矩阵\(\A = \begin{bmatrix} 1 & 7 \\ 2 & 6 \\ -3 & 1 \end{bmatrix}\)的秩、行秩与列秩.
\begin{solution}
因为至少存在一个\(\A\)的二阶子式不为零，即\[
\begin{vmatrix} 1 & 7 \\ 2 & 6 \end{vmatrix} = -8 \neq 0,
\]且\(\A\)没有三阶子式，所以\(\rank\A = 2\).

写出\(\A\)的行向量组\[
(1,7), \qquad
(2,6), \qquad
(-3,1),
\]分别转置后，列成一个矩阵（显然就是\(\A^T\)），作初等行变换化成阶梯形矩阵\[
\A^T = \begin{bmatrix}
1 & 2 & -3 \\
7 & 6 & 1
\end{bmatrix} \to \begin{bmatrix}
1 & 0 & 17/2 \\
0 & 4 & -11
\end{bmatrix} = \B_1.
\]阶梯形矩阵\(\B_1\)有2行不为零，故矩阵\(\A\)的行秩为2.

写出\(\A\)的列向量组\[
(1,2,-3)^T,\,(7,6,1)^T,
\]列成一个矩阵（显然就是\(\A\)本身），作初等行变换化成阶梯形矩阵\[
\A = \begin{bmatrix} 1 & 7 \\ 2 & 6 \\ -3 & 1 \end{bmatrix}
\to \begin{bmatrix} 1 & 0 \\ 0 & 1 \\ 0 & 0 \end{bmatrix} = \B_2.
\]阶梯形矩阵\(\B_2\)有2行不为零，故矩阵\(\A\)的列秩为2.
\end{solution}
\end{example}

\begin{example}
设\(\a_1=(1,2,-1,0)^T,\a_2=(1,1,0,2)^T,\a_3=(2,1,1,a)^T\).
若\(\dim\opair{\AutoTuple{\a}{3}}=2\)，求\(a\).
\begin{solution}
除了利用\cref{equation:线性方程组.子空间的维数与向量组的秩的联系} 在将矩阵\[
\A = (\a_1,\a_2,\a_3) = \begin{bmatrix}
1 & 1 & 2 \\
2 & 1 & 1 \\
-1 & 0 & 1 \\
0 & 2 & a
\end{bmatrix}
\]化为阶梯形矩阵以后，根据\(\rank\{\AutoTuple{\a}{3}\}=2\)求出\(a\)的值这种方法以外，%
我们还可以利用本节\hyperref[definition:线性方程组.矩阵的秩的定义]{矩阵的秩的定义}，%
得出\(\rank\A=\dim\opair{\AutoTuple{\a}{3}}=2\)这一结论，从而根据\cref{theorem:线性方程组.矩阵的秩的性质3} 可知\(\A\)中任意3阶子式全都为零.
对于\(\A\)这么一个\(4\times3\)矩阵，任意去掉不含\(a\)的一行（不妨去掉第一行）得到一个行列式必为零：\[
\begin{vmatrix}
2 & 1 & 1 \\
-1 & 0 & 1 \\
0 & 2 & a
\end{vmatrix}
= a - 6 = 0,
\]解得\(a = 6\).
\end{solution}
\end{example}

\subsection{矩阵的秩、行秩、列秩的关系}
\begin{lemma}
设矩阵\(\A = (a_{ij})_{s \times n}\)的列秩等于\(\A\)的列数\(n\)，则\(\A\)行秩、秩都等于\(n\).
\begin{proof}
对\(\A\)分别进行列分块与行分块：\[
\A = (\AutoTuple{\a}{n})
= \begin{bmatrix} \A_1 \\ \A_2 \\ \vdots \\ \A_s \end{bmatrix}.
\]由于\(\A\)的列秩等于\(n\)，\(\A\)的列向量组线性无关，故齐次线性方程组\[
x_1 \a_1 + x_2 \a_2 + \dotsb + x_n \a_n = \z
\quad\text{或}\quad
\A\x=\z
\]只有零解；
进而有方程个数不小于未知量个数，即\(s \geqslant n\).

因为\(\A\)的行向量的维数是\(n\)，所以\(\A\)的行秩\(t \leqslant n\).
设\(\A\)的行极大线性无关组是\(\A_{i_1},\A_{i_2},\dotsc,\A_{i_t}\).
假设\(t < n\)，则\(\A\)可通过初等行变换化为\[
\begin{bmatrix}
\A_{i_1} \\ \A_{i_2} \\ \vdots \\ \A_{i_t} \\ \z_{(s-t) \times n}
\end{bmatrix},
\]于是，\(\A\x=\z\)表示的齐次线性方程组中，%
非零方程的个数\(t\)小于未知量个数\(n\)，%
故\(\A\x=\z\)有非零解，%
与\(\A\x=\z\)只有零解矛盾，%
所以假设\(t < n\)不成立，%
可得\(t = n\)，\(\A\)的行秩等于\(n\).
又因为\(\A\)的行极大线性无关组构成\(\A\)的\(n\)阶子式\[
\begin{vmatrix} \A_{i_1} \\ \A_{i_2} \\ \vdots \\ \A_{i_n} \end{vmatrix} \neq 0,
\]
\(\A\)没有阶数大于\(n\)的子式，故秩\(\A = n\).
\end{proof}
\end{lemma}

\begin{theorem}
矩阵的行秩、列秩、秩都相等.
\begin{proof}
如果矩阵\(\A = \z\)，%
则结论成立.

当\(\A \neq \z\)时，%
设\(r_{\A} = r\)，%
则\(\A\)的所有\(t\ (t > r)\)阶子式全为零，%
且\(\A\)有一个\(r\)阶子式不为零，%
该子式的列向量线性无关，%
添加分量得\(\A\)有\(r\)列线性无关，%
于是\(\A\)的列秩\(p \geqslant r\)；
由引理，\(\A\)的极大无关列构成的矩阵有一非零\(p\)阶子式，%
也是\(\A\)的子式，%
故\(p \leqslant r\)，%
得\(p = r\).

因此\(r_{\A}\)等于\(\A\)的列秩.

同样地，将这一结论用于\(\A^T\)，%
得\(r_{\A^T}\)等于\(\A^T\)的列秩，%
也就等于\(\A\)的行秩.
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:线性方程组.初等变换不变秩}
初等变换不改变矩阵的秩，即\[
\A\cong\B \implies \rank\A=\rank\B.
\]
\begin{proof}
因为初等行变换不改变矩阵的列秩；同理，初等列变换不改变矩阵的行秩；所以初等变换不改变矩阵的秩.
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:线性方程组.矩阵乘积的秩}
矩阵的乘积的秩\(r_{\A\B} \leqslant \min\{r_{\A},r_{\B}\}\).
\begin{proof}
设\(\C = \A\B\)，将\(\C\)、\(\B\)分别进行列分块得\[
\C = (\AutoTuple{\g}{n}),
\qquad
\B = (\AutoTuple{\b}{n}),
\]则\[
(\AutoTuple{\g}{n}) = \A (\AutoTuple{\b}{n}) = (\A\b_1,\A\b_2,\dotsc,\A\b_n),
\]于是\[
\g_i = \A \b_i,
\quad i=1,2,\dotsc,n.
\]

若\(\rank\B = t\)，%
则\(\B\)的任意\(t+1\)个列向量
\(\b_{k_1},\b_{k_2},\dotsc,\b_{k_{t+1}}\)
线性相关，%
存在不全为零的数
\(l_1,l_2,\dotsc,l_{t+1}\)
使得\[
l_1 \b_{k_1} + l_2 \b_{k_2} + \dotsb + l_{t+1} \b_{k_{t+1}} = \z,
\]
故\[
l_1 \g_{k_1} + l_2 \g_{k_2} + \dotsb + l_{t+1} \g_{k_{t+1}}
= \A(l_1 \b_{k_1} + l_2 \b_{k_2} + \dotsb + l_{t+1} \b_{k_{t+1}})
= \z,
\]
即\(\C\)的任意\(t+1\)个列向量线性相关，%
故\(\A\B\)的列秩小于或等于\(t\)，%
即\(\rank(\A\B) \leqslant \rank\B\).
又\[
\rank(\A\B)
= \rank(\A\B)^T
= \rank(\B^T \A^T)
\leqslant \rank \A
= \rank \A^T,
\]所以
\(r_{\A\B}
\leqslant
\min\{r_{\A},r_{\B}\}\).
\end{proof}
\end{theorem}

\begin{corollary}
设\(\A\)是一个\(s \times n\)矩阵，\(\P\)、\(\Q\)分别是\(s\)阶和\(n\)阶可逆矩阵，则\[
r_{\A} = r_{\P \A} = r_{\A \Q} = r_{\P \A \Q}.
\]
\begin{proof}
因为\(\A = (\P^{-1} \P) \A = \P^{-1} (\P \A)\)，由\cref{theorem:线性方程组.矩阵乘积的秩}，有\[
r_{\A} = r_{\P^{-1} (\P \A)} \leqslant r_{\P \A} \leqslant r_{\A},
\]所以\(r_{\A} = r_{\P \A}\)；同理可得\(r_{\A} = r_{\A \Q} = r_{\P \A \Q}\).
\end{proof}
\end{corollary}

\begin{theorem}
矩阵\(\A\)满足\(\rank\A=r\)的充要条件是：存在可逆矩阵\(\P,\Q\)，使得\[
\P \A \Q = \begin{bmatrix}
\E_r & \z \\ \z & \z
\end{bmatrix} = \B.
\]\rm
称矩阵\(\B\)为\(\A\)的\DefineConcept{等价标准型}.
\begin{proof}
充分性.如果可逆矩阵\(\P,\Q\)使得\[
\P\A\Q = \begin{bmatrix}
\E_r & \z \\ \z & \z
\end{bmatrix},
\]
把上式等号左边的可逆矩阵\(\P\)、\(\Q\)分别视作对矩阵\(\A\)的初等行变换和初等列变换，%
那么，根据\cref{theorem:线性方程组.初等变换不变秩}，%
所得矩阵\(\B\)的秩与原矩阵\(\A\)相同，%
即\[
\rank\A = \rank\B = r.
\qedhere
\]
%\cref{theorem:线性方程组.非零矩阵可经初等行变换化为若尔当阶梯形矩阵}
\end{proof}
\end{theorem}

\begin{theorem}
设\(\A\)与\(\B\)都是\(s \times n\)矩阵，则\(\A \cong \B\)的充要条件是：\(r_{\A} = r_{\B}\).
\begin{proof}
必要性.因为\(\A\)可经一系列初等变换化为\(\B\)，根据\cref{theorem:线性方程组.初等变换不变秩}，初等变换不改变矩阵的秩，所以\(r_{\A} = r_{\B}\).

充分性.已知\(r_{\A} = r_{\B} = r\).对\(\A\)作初等行变换可将其化简为仅前\(r\)行不为零的阶梯形矩阵\(\C\)，同样对\(\C\)作初等列变换可化简为\(\A\)的等价标准型.
对\(\B\)也可作初等变换化为等价标准型.
那么存在\(s\)阶可逆矩阵\(\P_1\)和\(\P_2\)，存在\(n\)阶可逆矩阵\(\Q_1\)和\(\Q_2\)，使得\[
\P_1 \A \Q_1 = \P_2 \A \Q_2 = \begin{bmatrix} \E_r & \z \\ \z & \z \end{bmatrix},
\]令\(\P = \P_2^{-1} \P_1\)，\(\Q = \Q_1 \Q_2^{-1}\)，则\(\P\)和\(\Q\)可逆，\(\P \A \Q = \B\)，从而\(\A \cong \B\).
\end{proof}
\end{theorem}

\begin{example}
试证：\begin{equation}
	\rank\begin{bmatrix} \A & \z \\ \z & \B \end{bmatrix} = \rank\A + \rank\B.
	\label{equation:矩阵的秩.分块矩阵的秩的等式1}
\end{equation}
\begin{proof}
设\(\rank\A = r_1, \rank\B = r_2\)，则存在可逆矩阵\(\P_1,\Q_1,\P_2,\Q_2\)，使得\[
\P_1 \A \Q_1 = \begin{bmatrix}
\E_{r_1} & \z \\
\z & \z
\end{bmatrix},
\qquad
\P_2 \B \Q_2 = \begin{bmatrix}
\E_{r_2} & \z \\
\z & \z
\end{bmatrix},
\]于是\[
\begin{bmatrix}
\P_1 & \z \\
\z & \P_2
\end{bmatrix} \begin{bmatrix}
\A & \z \\
\z & \B
\end{bmatrix} \begin{bmatrix}
\Q_1 & \z \\
\z & \Q_2
\end{bmatrix}
= \begin{bmatrix}
\P_1 \A \Q_1 & \z \\
\z & \P_2 \B \Q_2
\end{bmatrix}
= \begin{bmatrix}
\E_{r_1} \\
& \z \\
& & \E_{r_2} \\
& & & \z
\end{bmatrix}.
\]显然上式最右端矩阵的秩为\(r_1+r_2\)，而最左端的矩阵\(\begin{bmatrix}
\P_1 & \z \\
\z & \P_2
\end{bmatrix}\)和\(\begin{bmatrix}
\Q_1 & \z \\
\z & \Q_2
\end{bmatrix}\)都是可逆矩阵，与之相乘不改变矩阵\(\begin{bmatrix} \A & \z \\ \z & \B \end{bmatrix}\)的秩，说明\(\rank\begin{bmatrix} \A & \z \\ \z & \B \end{bmatrix} = r_1 + r_2 = \rank\A + \rank\B\).
\end{proof}
\end{example}

\begin{example}
试证：\begin{gather}
	\rank\begin{bmatrix} \A & \C \\ \z & \B \end{bmatrix} \geqslant \rank\A + \rank\B,
	\label{equation:矩阵的秩.分块矩阵的秩的不等式1} \\
	\rank\begin{bmatrix} \A & \z \\ \D & \B \end{bmatrix} \geqslant \rank\A + \rank\B.
	\label{equation:矩阵的秩.分块矩阵的秩的不等式2}
\end{gather}
\end{example}

\begin{example}
设\(\A,\B\in M_n(K)\)，\(\A\B=\B\A\)，证明：\[
	\rank(\A+\B)\leqslant\rank\A+\rank\B-\rank(\A\B).
\]
\begin{proof}
考虑\[
	\begin{bmatrix}
		\E & \E \\
		\z & \E
	\end{bmatrix}
	\begin{bmatrix}
		\A & \z \\
		\z & \B
	\end{bmatrix}
	\begin{bmatrix}
		\E & -\B \\
		\E & \A
	\end{bmatrix}
	= \begin{bmatrix}
		\A+\B & -\A\B+\B\A \\
		\B & \B\A
	\end{bmatrix}
	= \begin{bmatrix}
		\A+\B & \z \\
		\B & \A\B
	\end{bmatrix}.
\]
由\cref{equation:矩阵的秩.分块矩阵的秩的等式1,%
equation:矩阵的秩.分块矩阵的秩的不等式2} 可知\[
	\rank\A+\rank\B
	= \rank\begin{bmatrix}
		\A & \z \\
		\z & \B
	\end{bmatrix}
	\geqslant \rank\begin{bmatrix}
		\A+\B & \z \\
		\B & \B\A
	\end{bmatrix}
	\geqslant \rank(\A+\B) + \rank(\A\B).
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
设矩阵\(\A \in M_{s \times n}(P)\)，矩阵\(\B \in M_{s \times m}(P)\)，则
\begin{equation}
	\rank(\A,\B) \leqslant \rank\A + \rank\B.
\end{equation}
\begin{proof}
\def\as{\AutoTuple{\a}{n}}
\def\bs{\AutoTuple{\b}{m}}
\def\asi{\a_{i_1},\dotsc,\a_{i_r}}
\def\bsj{\b_{j_1},\dotsc,\b_{j_t}}
设\(\rank\A = r\)，\(\rank\B = t\).
对\(\A\)、\(\B\)分别按列分块得\[
	\A = (\as),
	\qquad
	\B = (\bs),
\]
则\[
	(\A,\B) = (\as,\bs),
\]且\[
	\rank\{\as\} = r,
	\quad
	\rank\{\bs\} = t.
\]

由于\(\as\)可由其极大线性无关组\[
	\asi
\]线性表出，
\(\bs\)可由其极大线性无关组\[
	\bsj
\]线性表出，
故\[
	V_1=\{\as,\bs\}
\]可由向量组\[
	V_2=\{\asi,\bsj\}
\]线性表出，
则\[
	\rank V_1
	\leqslant
	\rank V_2
	\leqslant
	r+t;
\]
于是\(\rank(\A,\B) = \rank V_1 \leqslant r+t\).
\end{proof}
\end{example}

\begin{example}
设\(\A\)、\(\B\)都是\(s \times n\)矩阵，证明：\(\rank(\A+\B) \leqslant \rank\A + \rank\B\).
\begin{proof}
\def\asi{\a_{i_1},\a_{i_2},\dotsc,\a_{i_r}}
\def\bsj{\b_{j_1},\b_{j_2},\dotsc,\b_{j_t}}
设\(\rank\A = r\)，\(\rank\B = t\).对\(\A\)、\(\B\)分别按列分块得\[
\A = (\AutoTuple{\a}{n}), \qquad
\B = (\AutoTuple{\b}{m}),
\]则\[
\A + \B = (\a_1 + \b_1,\a_2 + \b_2,\dotsc,\a_n + \b_n).
\]
由于\(\AutoTuple{\a}{n}\)可由其极大线性无关组\(\asi\)线性表出，%
\(\AutoTuple{\b}{m}\)可由其极大线性无关组\(\bsj\)线性表出，%
故\[
\a_1 + \b_1,\a_2 + \b_2,\dotsc,\a_n + \b_n
\]可由向量组\[
\asi,\bsj
\]线性表出，%
结论显然成立.
\end{proof}
\end{example}

\begin{example}
设\(\A\)是\(n\)阶矩阵，证明：\(n \leqslant \rank(\A + \E) + \rank(\A - \E)\).
\begin{proof}
可以证
\begin{align*}
\rank(\A + \E) + \rank(\A - \E)
&= \rank(\A + \E) + \rank[-(\A - \E)] \\
&\geqslant \rank\{(\A + \E) + [-(\A - \E)]\} \\
&= \rank(2\E) = \rank\E = n.
\qedhere
\end{align*}
\end{proof}
\end{example}

\begin{example}
设\(\A\)是\(s \times n\)矩阵（\(s \neq n\)），证明：\(\det(\A \A^T) \det(\A^T \A) = 0\).
\begin{proof}
由题有，\(\A^T \A\)是\(n\)阶矩阵，\(\A \A^T\)是\(s\)阶矩阵.

当\(s < n\)时，\(\rank(\A^T \A) \leqslant \min\{ \rank\A, \rank\A^T \} = \rank\A = \rank\A^T \leqslant \min\{s,n\} = s < n\)，\(n\)阶方阵\(\A^T \A\)不满秩，那么\(\det(\A^T \A) = 0\).

同理，当\(n < s\)时，\(\rank(\A \A^T) \leqslant \min\{s,n\} = n < s\)，那么\(\det(\A \A^T) = 0\).

综上所述，\(s \neq n\)时总有\(\det(\A \A^T) \det(\A^T \A) = 0\).
\end{proof}
\end{example}

\begin{example}
设\(\A\)是\(m \times n\)矩阵，\(\B\)是\(n \times m\)矩阵，\(\E\)是\(m\)阶单位矩阵.
已知\(\A\B = \E\)，求\(\rank\A,\rank\B\).
\begin{solution}
假设\(m > n\)，则由\cref{theorem:线性方程组.矩阵的秩的性质2} 可知\[
\rank\A,\rank\B \leqslant \min\{m,n\} = n.
\]再由\cref{theorem:线性方程组.矩阵乘积的秩} 可知\[
\rank(\A\B) \leqslant \min\{\rank\A,\rank\B\} \leqslant n < m.
\]但\(\rank(\A\B) = \rank\E = m\)，矛盾！
由此可知，必有\(m \leqslant n\)，那么\[
\rank\A,\rank\B \leqslant \min\{m,n\} = m,
\]因此\begin{align*}
m = \rank(\A\B) \leqslant \min\{\rank\A,\rank\B\} \leqslant m
&\implies
\min\{\rank\A,\rank\B\} = m \\
&\implies
m \leqslant \rank\A,\rank\B \leqslant m \\
&\implies \rank\A=\rank\B=m.
\end{align*}
\end{solution}
\end{example}

\subsection{柯西-比内公式}
\begin{theorem}
已知数域\(K\).
设矩阵\(\A \in M_{m \times n}(K),
\B \in M_{n \times m}(K)\).
那么\begin{enumerate}
\item 当\(m > n\)时，\(\abs{\A\B} = 0\).
\item 当\(m = n\)时，\(\abs{\A\B} = \abs{\A} \abs{\B}\).
\item 当\(m < n\)时，\begin{equation}\label{equation:线性方程组.柯西-比内公式}
\abs{\A\B}
= \sum\limits_{1 \leqslant i_1 < i_2 < \dotsb < i_m \leqslant n}
\MatrixMinor\A{
	1,2,\dotsc,m \\
	i_1,i_2,\dotsc,i_m
}
\MatrixMinor\B{
	i_1,i_2,\dotsc,i_m \\
	1,2,\dotsc,m
}.
\end{equation}
\rm\cref{equation:线性方程组.柯西-比内公式} 称为\DefineConcept{柯西-比内公式}.
\end{enumerate}
\begin{proof}
当\(m=n\)时，
根据\cref{theorem:行列式.矩阵乘积的行列式}，
\(\abs{\A\B} = \abs{\A} \abs{\B}\)总成立.

当\(m>n\)时，
根据\cref{theorem:线性方程组.矩阵的秩的性质2}，有\[\rank\A,\rank\B \leqslant \min\{m,n\} = n;\]
再根据\cref{theorem:线性方程组.矩阵乘积的秩}，有\[\rank(\A\B) \leqslant \min\{\rank\A,\rank\B\} = n < m,\]
也就是说，矩阵\(\A\B\)不满秩；
那么根据\cref{theorem:线性方程组.矩阵的秩的性质4} 可知\(\abs{\A\B} = 0\).

当\(m<n\)时，
考虑\(m+n\)阶分块矩阵\[
	\begin{bmatrix}
		\E_n & \B \\
		\z & \A\B
	\end{bmatrix},
\]
由于\[
	\begin{vmatrix}
		\E_n & \B \\
		\z & \A\B
	\end{vmatrix}
	= \abs{\E_n} \abs{\A\B}
	= \abs{\A\B},
\]
所以\[
	\begin{bmatrix}
		\E_n & \B \\
		\z & \A\B
	\end{bmatrix}
	\to
	\begin{bmatrix}
		\E_n & \B \\
		-\A & \z
	\end{bmatrix}
	= \begin{bmatrix}
		\E_n & \z \\
		-\A & \E_m
	\end{bmatrix} \begin{bmatrix}
		\E_n & \B \\
		\z & \A\B
	\end{bmatrix},
\]\[
	\begin{vmatrix}
		\E_n & \B \\
		-\A & \z
	\end{vmatrix}
	= \begin{vmatrix}
		\E_n & \z \\
		-\A & \E_m
	\end{vmatrix} \begin{vmatrix}
		\E_n & \B \\
		\z & \A\B
	\end{vmatrix}
	= \begin{vmatrix}
		\E_n & \B \\
		\z & \A\B
	\end{vmatrix},
\]
根据\hyperref[theorem:行列式.拉普拉斯定理]{拉普拉斯定理}，
把上式最左端行列式按后\(m\)行展开得\[
	\begin{vmatrix}
		\E_n & \B \\
		-\A & \z
	\end{vmatrix}
	= \sum\limits_{1 \leqslant i_1 < \dotsb < i_m \leqslant n}
	\MatrixMinor{(-\A)}{
		1,2,\dotsc,m \\
		i_1,i_2,\dotsc,i_m
	}
	(-1)^{[(n+1)+\dotsb+(n+m)]+(i_1+\dotsb+i_m)}
	\abs{(\e_{\mu_1},\dotsc,\e_{\mu_{n-m}},\B)},
\]
其中\(\Set{\mu_1,\dotsc,\mu_{n-m}}
= \Set{1,\dotsc,n}-\Set{i_1,\dotsc,i_s}\)，
且\(\mu_1<\dotsb<\mu_{n-m}\).

把\(\abs{(\e_{\mu_1},\dotsc,\e_{\mu_{n-m}},\B)}\)
按前\(n-m\)行展开得\[
	\abs{(\e_{\mu_1},\dotsc,\e_{\mu_{n-m}},\B)}
	= \abs{\E_{n-m}}
	(-1)^{(\mu_1+\dotsb+\mu_{n-m})+[1+\dotsb+(n-m)]}
	\MatrixMinor{\B}{
		i_1,i_2,\dotsc,i_m \\
		1,2,\dotsc,m
	}.
\]
因此\begin{align*}
	\begin{vmatrix}
		\E_n & \B \\
		-\A & \z
	\end{vmatrix}
	&= \sum\limits_{1 \leqslant i_1 < \dotsb < i_m \leqslant n}
	(-1)^{m+m^2+n+n^2}
	\MatrixMinor\A{
		1,2,\dotsc,m \\
		i_1,i_2,\dotsc,i_m
	}
	\MatrixMinor\B{
		i_1,i_2,\dotsc,i_m \\
		1,2,\dotsc,m
	} \\
	&= \sum\limits_{1 \leqslant i_1 < \dotsb < i_m \leqslant n}
	\MatrixMinor\A{
		1,2,\dotsc,m \\
		i_1,i_2,\dotsc,i_m
	}
	\MatrixMinor\B{
		i_1,i_2,\dotsc,i_m \\
		1,2,\dotsc,m
	}.
\end{align*}
综上所述，\[
	\abs{\A\B}
	= \sum\limits_{1 \leqslant i_1 \leqslant i_2 \leqslant \dotsb \leqslant i_m \leqslant n}
	\MatrixMinor\A{
		1,2,\dotsc,m \\
		i_1,i_2,\dotsc,i_m
	}
	\MatrixMinor\B{
		i_1,i_2,\dotsc,i_m \\
		1,2,\dotsc,m
	}.
\]
\end{proof}
\end{theorem}

\begin{example}
计算行列式\(\det\D\)，其中\[
\D = \begin{bmatrix}
1 & \cos(\alpha_1-\alpha_2) & \cos(\alpha_1-\alpha_3) & \dots & \cos(\alpha_1-\alpha_n) \\
\cos(\alpha_1-\alpha_2) & 1 & \cos(\alpha_2-\alpha_3) & \dots & \cos(\alpha_2-\alpha_n) \\
\cos(\alpha_1-\alpha_3) & \cos(\alpha_2-\alpha_3) & 1 & \dots & \cos(\alpha_3-\alpha_n) \\
\vdots & \vdots & \vdots & & \vdots \\
\cos(\alpha_1-\alpha_n) & \cos(\alpha_2-\alpha_n) & \cos(\alpha_3-\alpha_n) & \dots & 1
\end{bmatrix}.
\]
\begin{solution}
记\(\D = (d_{ij})_n\).
由\cref{equation:函数.三角函数.和积互化公式2} 可知\[
d_{ij} = \cos(\alpha_i-\alpha_j)
= \cos\alpha_i\cos\alpha_j+\sin\alpha_i\sin\alpha_j,
\quad i,j=1,2,\dotsc,n.
\]记\[
\A = \begin{bmatrix}
\cos\alpha_1 & \cos\alpha_2 & \dots & \cos\alpha_n \\
\sin\alpha_1 & \sin\alpha_2 & \dots & \sin\alpha_n
\end{bmatrix},
\]那么\(\D = \A^T \A\).

由\cref{theorem:线性方程组.矩阵的秩的性质2} 可知，%
\(\rank\A = \rank\A^T \leqslant \min\{n,2\}\).
由\cref{theorem:线性方程组.矩阵乘积的秩} 可知，\[
\rank(\A^T\A) \leqslant \min\left\{\rank\A^T,\rank\A\right\} = \rank\A.
\]

当\(n=1\)时，\(\abs{\D}=1\).

当\(n=2\)时，\[
\abs{\D} = \begin{vmatrix}
1 & \cos(\alpha_1-\alpha_2) \\
\cos(\alpha_1-\alpha_2) & 1
\end{vmatrix} = 1 - \cos^2(\alpha_1-\alpha_2).
\]

当\(n>2\)时，\(\rank(\A^T\A) \leqslant \rank\A \leqslant2\)，\(\D = \A^T \A\)不满秩，故由\cref{theorem:线性方程组.矩阵的秩的性质4} 有\(\abs{\D}=0\).
\end{solution}
\end{example}

\begin{example}
设\(\A \in M_{m \times n}(\mathbb{R})\).
求证：\begin{equation}
	\rank\A = \rank(\A\A^T).
\end{equation}
\begin{proof}
设\(\rank\A=r\)，%
由\hyperref[definition:线性方程组.矩阵的秩的定义]{矩阵的秩的定义}可知，
\(\A\)有\(r\)阶子式不等于零，即
\[
\MatrixMinor\A{
	\AutoTuple{i}{r} \\
	\AutoTuple{j}{r}
} \neq 0.
\eqno(1)
\]
由\hyperref[equation:线性方程组.柯西-比内公式]{柯西-比内公式}可知
\begin{align*}
\MatrixMinor{(\A\A^T)}{
	\AutoTuple{i}{r} \\
	\AutoTuple{i}{r}
}
&= \sum\limits_{1 \leqslant k_1 < k_2 < \dotsb < k_r \leqslant n}
\MatrixMinor\A{
	\AutoTuple{i}{r} \\
	\AutoTuple{k}{r}
}
\MatrixMinor{\A^T}{
	\AutoTuple{k}{r} \\
	\AutoTuple{i}{r}
} \\
&= \sum\limits_{1 \leqslant k_1 < k_2 < \dotsb < k_r \leqslant n}
\left[
	\MatrixMinor\A{
		\AutoTuple{i}{r} \\
		\AutoTuple{k}{r}
	}
\right]^2.
\tag2
\end{align*}
因为\(\A \in M_{m \times n}(\mathbb{R})\)，%
所以\(\A\)的任意子式都是实数，于是有
\[
\left[
	\MatrixMinor\A{
		\AutoTuple{i}{r} \\
		\AutoTuple{k}{r}
	}
\right]^2
\geqslant 0.
\eqno(3)
\]
由(1)式可知，%
\[
\left[
	\MatrixMinor\A{
		\AutoTuple{i}{r} \\
		\AutoTuple{j}{r}
	}
\right]^2
> 0.
\eqno(4)
\]
由于在(2)式中，%
求和指标可以\((\AutoTuple{k}{r})\)取到\((\AutoTuple{j}{r})\)，%
所以(4)式是(2)式中的一项.
综上所述
\[
\MatrixMinor{(\A\A^T)}{
	\AutoTuple{i}{r} \\
	\AutoTuple{i}{r}
}
=
\sum\limits_{1 \leqslant k_1 < k_2 < \dotsb < k_r \leqslant n}
\left[
	\MatrixMinor\A{
		\AutoTuple{i}{r} \\
		\AutoTuple{k}{r}
	}
\right]^2
> 0,
\]
这就说明\(\rank(\A\A^T) \geqslant r\).
又因为\(\rank(\A\A^T) \leqslant \rank\A = r\)，%
所以\(\rank(\A\A^T) = \rank\A = r\).
\end{proof}
\end{example}

\begin{example}
设\(\A = (\B,\C) \in M_{n \times m}(\mathbb{R})\)，其中\(\B \in M_{n \times s}(\mathbb{R})\)，\(\C \in M_{n \times (m-s)}(\mathbb{R})\).
证明：\begin{equation}
\abs{\A^T \A} \leqslant \abs{\B^T \B} \abs{\C^T \C}.
\end{equation}
\end{example}

\begin{example}
设\(\A = (a_{ij})_n \in M_n(\mathbb{R})\).
证明：\begin{equation}\label{equation:线性方程组.Hadamard不等式}
\abs{\A}^2 \leqslant \prod\limits_{j=1}^n \sum\limits_{i=1}^n a_{ij}^2.
\end{equation}
\end{example}

\begin{example}
设\(\A = (a_{ij})_n \in M_n(\mathbb{R})\)，且\(\abs{a_{ij}} < M\ (i,j=1,2,\dotsc,n)\).
证明：\begin{equation}
\abs{\det\A} \leqslant M^n n^{n/2}.
\end{equation}
\end{example}

\subsection{重要不等式}
\begin{theorem}[西尔维斯特不等式]
设\(\A\)是\(m \times n\)矩阵，\(\B\)是\(n \times t\)矩阵.证明：\begin{equation}\label{equation:线性方程组.西尔维斯特不等式}
\rank\A + \rank\B - n \leqslant \rank(\A \B).
\end{equation}
\begin{proof}
\def\AA{\P_1 \begin{bmatrix} \E_r & \z \\ \z & \z \end{bmatrix} \Q_1}
\def\BB{\P_2 \begin{bmatrix} \E_s & \z \\ \z & \z \end{bmatrix} \Q_2}
\def\CC#1{\C_{#1}}
设\(\rank\A = r\)，\(\rank\B = s\)，则存在可逆矩阵\(\P_1,\P_2,\Q_1,\Q_2\)使得\[
\A = \AA,
\quad
\B = \BB,
\]所以\[
\A \B = \AA \BB.
\]若\(\Q_1 \P_2 = \begin{bmatrix} \CC1 & \CC2 \\ \CC3 & \CC4 \end{bmatrix}\)（其中\(\CC1\)是\(r \times s\)矩阵），则\[
\A \B = \P_1 \begin{bmatrix} \CC1 & \z \\ \z & \z \end{bmatrix} \Q_2.
\]
注意到从任意一个矩阵中划去一行（或一列），\(\A\)的秩至多减少1，那么可以把\(\CC1\)看作将一个\(n\)阶方阵划去\(n-r\)行，并划去\(n-s\)列得到的，即\[
\rank\CC1 \geqslant n - (n-r) - (n-s) = r+s-n,
\]所以\(\rank\A + \rank\B - n \leqslant \rank(\A \B) = \rank\CC1\).
\end{proof}
\end{theorem}

上面的结果和\cref{theorem:线性方程组.矩阵乘积的秩} 一起可以确定矩阵乘积的秩的区间：\[
\rank\A + \rank\B - n \leqslant \rank(\A\B) \leqslant \min\{\rank\A,\rank\B\}.
\]
进一步，如果有\(\A\B=\z\)，那么\[
\rank\A + \rank\B \leqslant n.
\]

我们还可以将\hyperref[equation:线性方程组.西尔维斯特不等式]{西尔维斯特不等式}进行如下的推广：\begin{equation}\label{equation:线性方程组.弗罗贝尼乌斯不等式}
\rank(\A\B\C) \geqslant \rank(\A\B) + \rank(\B\C) - \rank\B.
\end{equation}称其为\DefineConcept{弗罗贝尼乌斯不等式}.
