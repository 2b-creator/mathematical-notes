\section{重因式}
上一节我们已证明\(K[x]\)中每一个次数大于零的多项式\(f(x)\)能唯一地分解成
数域\(K\)上有限多个不可约多项式的乘积.
如果\(f(x)\)的分解式中每一个不可约因式只出现\(1\)次，
这种情形是特别重要的情形.
这一节我们要给出识别这种情形的一个统一的方法.

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P29 定义1
设\(f(x),p(x) \in K[x]\).
如果\begin{enumerate}
	\item \(p(x)\)是不可约多项式，
	\item \(p^k(x) \mid f(x)\)，
	\item \(p^{k+1}(x) \nmid f(x)\)，
\end{enumerate}
那么称“\(p(x)\)是\(f(x)\)的~\DefineConcept{\(k\)重因式}”.

如果\(k=0\)，则\(p(x) \nmid f(x)\)，因此\(p(x)\)不是\(f(x)\)的因式.
如果\(k=1\)，则把\(p(x)\)称为“\(f(x)\)的\DefineConcept{单因式}”.
如果\(k>1\)，则把\(p(x)\)称为“\(f(x)\)的\DefineConcept{重因式}”.
\end{definition}

显然，如果\(f(x)\)的标准分解式为\[
	f(x) = c p_1^{r_1}(x) p_2^{r_2}(x) \dotsm p_m^{r_m}(x),
\]
则\(p_i^{r_i}(x)\ (i=1,2,\dotsc,m)\)是\(f(x)\)的\(r_i\)重因式.
指数\(r_i = 1\)的那些不可约因式是单因式，
指数\(r_i > 1\)的那些不可约因式是重因式.
因此，\(f(x)\)的分解式中每一个不可约因式只出现\(1\)的情形也就是\(f(x)\)没有重因式的情形.
如何判别一个多项式有没有重因式呢？
由于没有一般的方法来求一个多项式的标准分解式，
因此我们必须寻找别的方法来判断一个多项式有没有重因式.

我们先来看一个简单例子，以便从中受到启发.

设\(f(x) = (x+1)^3 \in \mathbb{R}[x]\)，
这时\(f(x)\)有重因式.
如果我们把\(f(x)\)看成数学分析中讨论的多项式函数，
那么对\(f(x)\)可以求导数，得\(f'(x) = 3(x+1)^2\).
于是\((f(x),f'(x)) = (x+1)^2\).
从这个例子受到启发，
有可能运用导数概念以及最大公因式的求法来讨论一个多项式有没有重因式的问题.
由于我们现在讲的多项式是任意数域\(K\)上一个不定元的多项式，
而数学分析中的多项式函数是实变量\(x\)的函数，
其导数概念涉及极限概念，
因此我们不能直接引用数学分析中多项式函数的导数概念，
我们必须给任意数域\(K\)上一元多项式的导数下个定义，
当然这个定义是从数学分析中多项式函数的导数公式得到启发的.

\begin{definition}\label{definition:多项式.导数}
%@see: 《高等代数（第三版 下册）》（丘维声） P30 定义2
对于\(K[x]\)中的多项式\[
	f(x) = a_n x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0,
\]
我们把\(K[x]\)中的多项式\[
	n a_n x^{n-1} + (n-1) a_{n-1} x^{n-2} + \dotsb + a_1
\]
叫做“\(f(x)\)的\DefineConcept{一阶导数}”，记作\(f'(x)\).
我们还把\(f'(x)\)的一阶导数称为“\(f(x)\)的\DefineConcept{二阶导数}”，记作\(f''(x)\)；
把\(f''(x)\)的一阶导数称为“\(f(x)\)的\DefineConcept{三阶导数}”，记作\(f'''(x)\)；
把\(f'''(x)\)的一阶导数称为“\(f(x)\)的\DefineConcept{四阶导数}”，记作\(f^{(4)}(x)\)；
以此类推.
\end{definition}

从\cref{definition:多项式.导数} 立即得出，
一个\(n\)次多项式的导数是一个\(n-1\)次多项式，
它的\(n\)阶导数是\(K\)中一个非零数，
它的\(n+1\)阶导数等于零.
零多项式的导数是零多项式.

根据\cref{definition:多项式.导数}，可以验证得到\(K[x]\)中多项式的导数的基本公式：\begin{gather}
	[f(x)+g(x)]' = f'(x) + g'(x), \\
	[c f(x)]' = c f'(x), \quad c \in K, \\
	[f(x) g(x)]' = f'(x) g(x) + f(x) g'(x), \\
	[f^m(x)]' = m f^{m-1}(x) f'(x).
\end{gather}

让我们回头再看一遍之前举的简单例子，
不可约多项式\(x+1\)是\(f(x) = (x+1)^3\)的\(3\)重因式.
由于按\cref{definition:多项式.导数} 和上述公式可得出，
\(f'(x) = 3(x+1)^2\)，
因此\(x+1\)是\(f'(x)\)的\(2\)重因式.
我们从这个例子得出的结论具有一般性.

\begin{theorem}\label{theorem:多项式.多项式及其导数的重因式}
%@see: 《高等代数（第三版 下册）》（丘维声） P30 定理1
设\(K\)是数域，在\(K[x]\)中，
如果不可约多项式\(p(x)\)是\(f(x)\)的一个\(k\ (k\geq1)\)重因式，
则\(p(x)\)是\(f(x)\)的导数\(f'(x)\)的一个\(k-1\)重因式.
特别地，多项式\(f(x)\)的单因式不是\(f(x)\)的导数\(f'(x)\)的因式.
\end{theorem}

\begin{corollary}\label{theorem:多项式.不可约多项式是重因式的充分必要条件}
%@see: 《高等代数（第三版 下册）》（丘维声） P31 推论2
设\(K\)是数域，在\(K[x]\)中，不可约多项式\(p(x)\)是\(f(x)\)的重因式的充分必要条件是：
\(p(x)\)是\(f(x)\)与\(f'(x)\)的公因式.
\end{corollary}
从\cref{theorem:多项式.不可约多项式是重因式的充分必要条件} 立即得到：
\(K[x]\)中次数大于零的多项式\(f(x)\)有重因式的充分必要条件是\(f(x)\)及其导数\(f'(x)\)
有次数大于零的公因式.
于是我们有下述定理.
\begin{theorem}\label{theorem:多项式.高次多项式没有重因式的充分必要条件}
%@see: 《高等代数（第三版 下册）》（丘维声） P31 定理3
设\(K\)是数域，\(K[x]\)中次数大于零的多项式\(f(x)\)没有重因式的充分必要条件是：
\(f(x)\)与它的导数\(f'(x)\)互素.
\end{theorem}

\cref{theorem:多项式.高次多项式没有重因式的充分必要条件} 表明，
判断数域\(K\)上的一个多项式\(f(x)\)有没有重因式，
只要利用辗转相除法去计算最大公因式\((f(x),f'(x))\).
不仅如此，由于在数域扩大时，两个多项式的互素性不改变，一个多项式的导数也不改变，
因此我们还有下述结论.

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P31 命题4
设\(F,K\)都是数域，\(F \supseteq K\).
对于\(f \in K[x]\)，
\(f(x)\)在\(K[x]\)中没有重因式的充分必要条件是：
\(f(x)\)有无重因式不会随数域的扩大而改变，
即当把\(f(x)\)看成\(F[x]\)中的多项式时，
\(f(x)\)在\(F[x]\)中没有重因式.
\end{proposition}

在一些问题中，如果多项式\(f(x)\)有重因式，
我们希望求出一个多项式\(g(x)\)，
它没有重因式，
并且在不计重数时，它与\(f(x)\)含有完全相同的不可约因式.
下面我们来讨论如何求解\(g(x)\).

设\(K[x]\)中的多项式\(f(x)\)的标准分解式是\[
	f(x) = c p_1^{r_1}(x) p_2^{r_2}(x) \dotsm p_m^{r_m}(x),
\]
根据\cref{theorem:多项式.多项式及其导数的重因式} 得\[
	f'(x) = p_1^{r_1-1}(x) p_2^{r_2-1}(x) \dotsm p_m^{r_m-1}(x) h(x),
\]
其中\(h(x)\)不能被\(p_i(x)\ (i=1,2,\dotsc,m)\)整除.
于是我们可以利用辗转相除法求得最大公因式\[
	(f(x),f'(x))
	= p_1^{r_1-1}(x) p_2^{r_2-1}(x) \dotsm p_m^{r_m-1}(x).
\]
因此用\((f(x),f'(x))\)除\(f(x)\)所得商式是\[
	c p_1(x) p_2(x) \dotsm p_m(x),
\]
把这个商式记作\(g(x)\)，
我们便得到一个没有重因式的多项式\(g(x)\)，
它与\(f(x)\)含有完全相同的不可约因式（不计重数）.

去掉\(f(x)\)的不可约因式的重数有不少好处.
例如，为了求\(f(x)\)的所有不可约因式，
我们可以先用上述方法得到一个没有重因式的多项式\(g(x)\)，
它与\(f(x)\)含有完全相同的不可约因式（不计重数），
但由于\(g(x)\)的次数小于\(f(x)\)的次数，
所以\(g(x)\)的不可约因式可能比较容易求得.
如果我们求出了\(g(x)\)的一个不可约因式\(p_i(x)\)，
那么用带余除法可求出\(p_i(x)\)在\(f(x)\)中的重数.
又如，在实际问题中常常需要求出一个多项式\(f(x)\)的根，
由于有些求多项式的根的算法只对没有重因式的多项式适用，
因此我们可以先去掉\(f(x)\)的不可约因式的重数，
得到一个没有重因式的多项式\(g(x)\)，
而\(g(x)\)与\(f(x)\)有完全相同的根（不计重数）.

\begin{example}
证明：\(\mathbb{Q}[x]\)中的多项式\[
	f(x) = 1+x+\frac{x^2}{2!}+\dotsb+\frac{x^n}{n!}
\]没有重因式.
\begin{proof}
求\(f(x)\)的导数得\[
	f'(x) = 1+x+\dotsm+\frac{x^{n-1}}{(n-1)!}.
\]
于是\[
	f(x) = f'(x) + \frac{x^n}{n!}.
\]
那么\[
	(f(x),f'(x))
	= \left(
		f'(x)+\frac{x^n}{n!},
		f'(x)
	\right)
	= \left(
		\frac{x^n}{n!},
		f'(x)
	\right).
\]
由于\(\frac{x^n}{n!}\)的不可约因式只有\(x\)（不计重数），
而\(x \nmid f'(x)\)，所以\[
	\left(
		\frac{x^n}{n!},
		f'(x)
	\right)
	= 1,
\]
从而\((f(x),f'(x))=1\).
因此，\(f(x)\)没有重因式.
\end{proof}
\end{example}
