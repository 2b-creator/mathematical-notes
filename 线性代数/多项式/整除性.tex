\section{整除性，带余除法}
从一元多项式环的通用性质看到，
我们应当尽可能多地得到\(K[x]\)中有关加法和乘法的等式，
为此需要研究一元多项式环\(K[x]\)的结构.
从本节开始我们将主要研究\(K[x]\)的结构，其中\(K\)是任一数域.

观察\(K[x]\)中两个多项式\(f(x)\)与\(g(x)\)之间有什么关系：\[
	f(x)=x^2-1, \qquad
	g(x)=x-1.
\]
显然，\[
	f(x)=(x+1) g(x).
\]
由此我们抽象出“整除”的概念.

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 定义1
设\(f,g \in K[x]\).
如果存在\(h \in K[x]\)，使得\[
	f(x) = h(x) g(x),
\]
则称“\(g(x)\) \DefineConcept{整除} \(f(x)\)”，
记作\(g(x) \mid f(x)\)，
又称“\(g(x)\)是\(f(x)\)的\DefineConcept{因式}”
“\(f(x)\)是\(g(x)\)的\DefineConcept{倍式}”；
否则称“\(g(x)\)不能整除\(f(x)\)”，
记作\(g(x) \nmid f(x)\).
\end{definition}

容易看出下列事实：
\begin{enumerate}
	\item \(0 \mid f(x) \iff f(x) = 0\).
	\item \((\forall f \in K[x])[f(x) \mid 0]\).
	\item \((\forall b \in K - \{0\})(\forall f \in K[x])[b \mid f(x)]\).
\end{enumerate}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P13 习题7.2 1.
证明：整除关系具有传递性，即在\(K[x]\)中，\[
	(\forall f,g,h \in K[x])
	[
		f(x) \mid g(x) \land g(x) \mid h(x)
		\implies
		f(x) \mid h(x)
	].
\]
\begin{proof}
假设\(f(x) \mid g(x), g(x) \mid h(x)\).
由定义可知，存在\(u,v \in K[x]\)，
使得\[
	g(x) = u(x) f(x), \qquad
	h(x) = v(x) g(x),
\]
于是\[
	h(x) = v(x) u(x) f(x).
\]
这就是说\(f(x) \mid h(x)\).
\end{proof}
\end{example}

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 定义2
在\(K[x]\)中，如果\(f(x) \mid g(x)\)且\(g(x) \mid f(x)\)，
则称“\(f(x)\)与\(g(x)\) \DefineConcept{相伴}”，
记作\(f(x) \sim g(x)\).
\end{definition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 命题1
在\(K[x]\)中，\(f(x) \sim g(x)\)当且仅当存在\(c \in K-\{0\}\)，使得\[
	f(x) = c g(x).
\]
\begin{proof}
充分性.
假设\(f(x)=c g(x)\)，其中\(c \in K-\{0\}\).
显然有\(g(x) \mid f(x)\).
又因为\(g(x)=\frac1c f(x)\)，
所以\(f(x) \mid g(x)\).
因此\(f(x) \sim g(x)\).

必要性.
假设\(f(x) \sim g(x)\).
由定义有\(f(x) \mid g(x)\)和\(g(x) \mid f(x)\).
于是存在\(h_1(x),h_2(x) \in K[x]\)，
使得\[
	g(x) = h_1(x) f(x), \qquad
	f(x) = h_2(x) g(x).
\]
于是\[
	f(x) = h_2(x) h_1(x) f(x).
\]
如果\(f(x)=0\)，则\(g(x)=0\).
下面假设\(f(x)\neq0\).
运用消去律，
由上式可得\[
	1 = h_2(x) h_1(x).
\]
继而可得\[
	\deg h_2(x) + \deg h_1(x) = 0.
\]
因此\(\deg h_1(x) = \deg h_2(x) = 0\)，
从而\(h_2(x)\)等于\(K\)中某个非零常数\(c\)，
于是\(f(x) = c g(x)\).
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 命题2
在\(K[x]\)中，如果\(g(x) \mid f_i(x)\ (i=1,2,\dotsc,s)\)，
则对于任意\(u_i \in K[x]\ (i=1,2,\dotsc,s)\)，有\[
	g(x) \mid (u_1(x) f_1(x) + u_2(x) f_2(x) + \dotsb + u_s(x) f_s(x)).
\]
%TODO proof
\end{proposition}

在\(K[x]\)中，如果\(g(x)\)不能整除\(f(x)\)，
那么能有什么样的结论呢？
例如，设\(f(x)=x^2,
g(x)=x-1\)，
则\[
	f(x)=x^2-1+1=(x+1)g(x)+1.
\]
由此受到启发，我们可以给出如下结论.
\begin{theorem}\label{theorem:多项式.带余除法}
%@see: 《高等代数（第三版 下册）》（丘维声） P11 定理3
对于\(K[x]\)中任意两个多项式\(f(x)\)与\(g(x)\)，其中\(g(x)\neq0\)，
则在\(K[x]\)中存在唯一的一对多项式\(h(x),r(x)\)，使得\[
	f(x) = h(x) g(x) + r(x),
	\qquad
	\deg r(x) < \deg g(x).
\]
\begin{proof}
存在性.
假设被除式\(f(x)\)的次数为\(n\)，
除式\(g(x)\)的次数为\(m\)，
即\(\deg f(x)=n\in\mathbb{N}\)，
\(\deg g(x)=m\in\mathbb{N}\).
让我们分情况讨论：\begin{enumerate}
	\item[情形1]
	当\(m=0\)时，
	除式\(g(x)\)是零次多项式，
	不妨设\(g(x)\)等于\(K\)中某个非零常数\(b\).
	于是\[
		f(x) = \left[ \frac1b f(x) \right] + 0,
		\qquad
		\deg 0 < \deg g(x).
	\]

	\item[情形2]
	当\(m>0\)且\(\deg f(x) = n < m\)时，
	有\[
		f(x) = 0 g(x) + f(x), \qquad
		\deg f(x) < \deg g(x).
	\]

	\item[情形3]
	当\(m>0\)且\(\deg f(x) = n \geq m\)时，
	对被除式\(f(x)\)的次数\(n\)运用数学归纳法.

	假设对于次数小于\(n\)的被除式，
	命题的存在性部分成立.
	现在来看\(n\)次多项式\(f(x)\).

	设\(f(x),g(x)\)的首项分别是\(a_n x^n,b_m x^m\).
	于是\(a_n b_m^{-1} x^{n-m} g(x)\)的首项是\(a_n x^n\).
	令\(f_1(x) = f(x) - a_n b_m^{-1} x^{n-m} g(x)\)，
	则\(\deg f_1(x) < n\).
	根据归纳假设，
	存在\(h_1(x),r_1(x) \in K[x]\)，
	使得\[
		f_1(x) = h_1(x) g(x) + r_1(x), \qquad
		\deg r_1(x) < \deg g(x).
	\]
	于是\begin{align*}
		f(x)
		&= f_1(x) + a_n b_m^{-1} x^{n-m} g(x) \\
		&= [h_1(x) + a_n b_m^{-1} x^{n-m}] g(x) + r_1(x).
	\end{align*}
	因此，只需要令\(h(x) = h_1(x) + a_n b_m^{-1} x^{n-m}\)，
	就有\[
		f(x) = h(x) g(x) + r_1(x),
		\qquad
		\deg r_1(x) < \deg g(x).
	\]
\end{enumerate}

唯一性.
设\(h(x),r(x),h'(x),r'(x) \in K[x]\)，
使得\begin{gather*}
	f(x) = h(x) g(x) + r(x), \qquad \deg r(x) < \deg g(x), \\
	f(x) = h'(x) g(x) + r'(x), \qquad \deg r'(x) < \deg g(x).
\end{gather*}
于是有\[
	h(x) g(x) + r(x)
	= h'(x) g(x) + r'(x),
\]
即\[
	[h(x) - h'(x)] g(x) = r'(x) - r(x).
\]
那么\begin{align*}
	\deg[h(x) - h'(x)] + \deg g(x)
	&= \deg[r'(x) - r(x)] \\
	&\leq \max\{
		\deg r'(x),
		\deg r(x)
	\}
	< \deg g(x).
\end{align*}
假设\(h(x) \neq h'(x)\)，
那么由上式可知\[
	\deg[h(x) - h'(x)] < 0,
\]
矛盾！
因此必有\(h(x) = h'(x)\).
从而又有\(r(x) = r'(x)\).
\end{proof}
\end{theorem}

\cref{theorem:多项式.带余除法} 中的\(h(x)\)称为“\(g(x)\)除\(f(x)\)的\DefineConcept{商式}”，
\(r(x)\)称为“\(g(x)\)除\(f(x)\)的\DefineConcept{余式}”.

\begin{corollary}\label{theorem:多项式.带余除法.推论}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 推论4
设\(f,g \in K[x]\)，且\(g(x) \neq 0\)，
则\(g(x) \mid f(x)\)当且仅当\(g(x)\)除\(f(x)\)的余式为零.
\begin{proof}
由\cref{theorem:多项式.带余除法} 立即可得\begin{align*}
	g(x) \mid f(x)
	&\iff
	f(x) = h(x) g(x), \qquad
	h(x) \in K[x] \\
	&\iff
	\text{$g(x)$除$f(x)$的余式是$0$}.
	\qedhere
\end{align*}
\end{proof}
\end{corollary}

利用带余除法可以证明：
对于\(K[x]\)中的多项式\(f(x),g(x)\)，
如果在\(K[x]\)中，\(g(x)\)不能整除\(f(x)\)，
那么把数域\(K\)扩大成数域\(F\)后，
在\(F[x]\)中，\(g(x)\)仍然不能整除\(f(x)\).

\begin{proposition}\label{theorem:多项式.整除性不随数域的扩大而改变}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 命题5
设\(F,K\)都是数域，且\(F \supseteq K\).
如果\(f,g \in K[x]\)，那么\[
	\text{在\(K[x]\)中成立\(g(x) \mid f(x)\)}
	\iff
	\text{在\(F[x]\)中成立\(g(x) \mid f(x)\)}.
\]
\begin{proof}
必要性.
假设在\(K[x]\)中，\(g(x) \mid f(x)\)，
则存在\(h(x) \in K[x]\)，
使得\(f(x) = h(x) g(x)\).
由于\(K \subseteq F\)，
因此\(f(x),g(x),h(x) \in K[x]\).
从而在\(F[x]\)中，\(g(x) \mid f(x)\).

充分性.
假设在\(F[x]\)中，\(g(x) \mid f(x)\).
我们分以下两种情况讨论：\begin{enumerate}
	\item 当\(g(x)\neq0\)时，
	在\(K[x]\)中作带余除法，
	有\(h(x),r(x) \in K[x]\)，
	使得\[
		f(x) = h(x) g(x) + r(x), \qquad
		\deg r(x) < \deg g(x).
	\]
	由于\(f(x),g(x),h(x),r(x) \in F[x]\)，
	因此上式也可以看成是在\(F[x]\)中的带余除法.
	由于在\(F[x]\)中，
	\(g(x) \mid f(x)\)，
	因此根据\cref{theorem:多项式.带余除法.推论}
	得\(r(x) = 0\).
	从而在\(K[x]\)中，有\(g(x) \mid f(x)\).

	\item 当\(g(x)=0\)时，
	从\(g(x) \mid f(x)\)得\(f(x)=0\).
	从而在\(K[x]\)中，也有\(g(x) \mid f(x)\).
\end{enumerate}
综上所述，在\(K[x]\)中，总有\(g(x) \mid f(x)\).
\end{proof}
\end{proposition}

\cref{theorem:多项式.整除性不随数域的扩大而改变} 表明，整除性不随数域的扩大而改变.

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 例1
设\(f(x) = 2x^3+3x^2+5\)，
\(g(x) = x^2+2x-1\)，
求用\(g(x)\)除\(f(x)\)的商式与余式.
\begin{solution}
我们可以参考整数除法的竖式，作出如下计算：
\[
	\begin{array}{r|*4r|l}
		x^2+2x-1 &
		2x^3 & +3x^2 & & +5
		& 2x-1 \\
		& 2x^3 & +4x^2 & -2x & \\ \cline{2-5}
		& & -x^2 & +2x & +5 \\
		& & -x^2 & -2x & +1 \\ \cline{3-5}
		& & & 4x & +4
	\end{array}
\]
因此\[
	2x^3+3x^2+5=(2x-1)(x^2+2x-1)+(4x+4),
\]
即\(g(x)\)除\(f(x)\)的商式是\(2x-1\)，余式是\(4x+4\).
\end{solution}
\end{example}
