\chapter{导数与微分}
\section{导数的基本概念}
\subsection{导数的定义}
\begin{definition}
设函数\(y=f(x)\)在点\(x_0\)的某个邻域内有定义，
当自变量\(x\)在\(x_0\)处取得增量\(\increment x\)（点\(x_0+\increment x\)仍在该邻域内）时，
相应的函数取得增量\(\increment y = f(x_0 + \increment x) - f(x_0)\)；
如果\(\increment y\)与\(\increment x\)之比当\(\increment x\to0\)时的极限存在，
即\[
	(\exists A \in \mathbb{R})
	\left[
		\lim\nolimits_{\increment x\to0}
		\tfrac{f(x_0+\increment x)-f(x_0)}{\increment x}
		= A
	\right],
\]
则称“函数\(y=f(x)\)在点\(x_0\)处\DefineConcept{可导}”，
或“\(f(x)\)在点\(x_0\)具有导数”，
或“\(f(x)\)在点\(x_0\)导数存在”；
并称这个极限为“函数\(y=f(x)\)在点\(x_0\)处的导数”，
记为\(f'(x_0)\)，即
\begin{equation}
	f'(x_0)
	= \lim\limits_{\increment x\to0} \frac{\increment y}{\increment x}
	= \lim\limits_{\increment x\to0} \frac{f(x_0+\increment x)-f(x_0)}{\increment x}
\end{equation}
也可记作
\[
	y'\eval_{x=x_0}, \qquad
	\dv{y}{x}\eval_{x=x_0}, \qquad
	f'(x_0), \qquad
	\dv{f(x)}{x}\eval_{x=x_0}, \quad\text{或}\quad
	\left[\dv{x} f(x)\right]_{x=x_0}.
\]
\end{definition}

导数的定义式可取不同的形式，如\begin{equation}
f'(x_0) = \lim\limits_{x \to x_0}\frac{f(x) - f(x_0)}{x - x_0}.
\end{equation}

\begin{definition}
称极限\[\lim\limits_{h\to0^-} \frac{f(x_0+h)-f(x_0)}{h}\]为%
“函数\(f(x)\)在点\(x_0\)处的\DefineConcept{左导数}（left-sided derivative）”，
记作\(f'_-(x_0)\).

称极限\[\lim\limits_{h\to0^+} \frac{f(x_0+h)-f(x_0)}{h}\]为%
和“函数\(f(x)\)在点\(x_0\)处的\DefineConcept{右导数}（right-sided derivative）”，
记作\(f'_+(x_0)\).

左导数和右导数统称\DefineConcept{单侧导数}（one-sided derivative）.
\end{definition}

\begin{theorem}[导数存在的充要条件]
函数\(f(x)\)在点\(x_0\)处可导的充要条件是%
其左导数\(f'_-(x_0)\)和右导数\(f'_+(x_0)\)都存在且相等.
\end{theorem}

\begin{definition}
如果函数\(y = f(x)\)在开区间\((a,b)\)内的每点处都可导，
就称“函数\(f(x)\)在开区间\((a,b)\)内可导”.

如果函数\(f(x)\)在开区间\((a,b)\)内可导，
且\(f'_+(a)\)及\(f'_-(b)\)都存在，
就说“函数\(f(x)\)在闭区间\([a,b]\)上可导”.
\end{definition}

\begin{definition}
设函数\(y = f(x)\)在区间\(I\)内的每点处都可导，
即对于\(\forall x_0 \in I\)，都对应着\(f(x_0)\)的一个确定的导数值\(f'(x_0)\).
这样就构成一个新的函数，这个函数叫做原来函数\(y = f(x)\)的\DefineConcept{导函数}（简称导数），
记作\(y'\)，\(f'(x)\)，\(\dv{y}{x}\)，\(\dv{f(x)}{x}\)或\(\dv{x} f(x)\).
\end{definition}

\begin{definition}\label{definition:函数族.可导函数族}
由区间\(I\)上全部的可导函数组成的集合，称作\DefineConcept{可导函数族}，
记作\(D(I)\)\footnote{当\(I=(a,b)\)时，可改写为\(D(a,b)\)，以此类推.}，
即\[
	D(I)
	\defeq
	\Set*{
		f\in\mathbb{R}^I
		\given
		(\forall x \in I)
		[\text{\(f\)在点\(x\)处可导}]
	}.
\]
\end{definition}

\begin{example}
求函数\(f(x) = C\)的导数，其中\(C\)为常数.
\begin{solution}
\(f'(x)
= \lim\limits_{h\to0}\frac{C-C}{h}
= 0\).
\end{solution}
\end{example}

\begin{example}
求函数\(f(x) = x^n\)在\(x=a\)处的导数，其中\(a\in\mathbb{R},
n\in\mathbb{N}^+\).
\begin{solution}
\(f'(a)
= \lim\limits_{x \to a}\frac{x^n-a^n}{x-a}
= \lim\limits_{x \to a}(x^{n-1}+ax^{n-2}+\dotsb+a^{n-1})
= na^{n-1}\).
\end{solution}
\end{example}

更一般地，对于幂函数\(y=x^{\mu}\ (\mu\in\mathbb{R})\)，有\begin{equation}
	(x^{\mu})' = \mu x^{\mu-1}.
\end{equation}

\begin{example}
求函数\(f(x) = \sin x\)的导数.
\begin{solution}
\(f'(x) = \lim\limits_{h\to0}\frac{\sin(x+h)-\sin x}{h}
= \lim\limits_{h\to0}{\cos(x+\frac{h}{2}) \frac{\sin(h/2)}{h/2}}
= \cos x\).
\end{solution}
\end{example}

\begin{example}
求函数\(f(x) = a^x\ (a > 0 \land a \neq 1)\)的导数.
\begin{solution}
\(f'(x)
= \lim\limits_{h\to0}\frac{a^{x+h}-a^x}{h}
= a^x \lim\limits_{h\to0}\frac{a^h-1}{h}
= a^x \ln a\).
\end{solution}

特别地，当\(a=e\)时，因\(\ln e = 1\)，故有\[
	(e^x)' = e^.
\]
\end{example}

\begin{example}
求函数\(f(x) = \log_a x\ (a > 0 \land a \neq 1)\)的导数.
\begin{solution}
\(f'(x)
= \lim\limits_{h\to0}\frac{\log_a(x+h)-\log_a x}{h}
= \lim\limits_{h\to0}{\frac{1}{h} \log_a\frac{x+h}{x}}
= \frac{1}{x} \lim\limits_{h\to0}\frac{\log_a(1+h/x)}{h/x}
= \frac{1}{x \ln a}\).
\end{solution}
\end{example}

\begin{example}
求函数\(f(x) = \abs{x}\)在\(x=0\)处的导数.
\begin{solution}
\(\frac{f(0+h)-f(0)}{h} = \frac{\abs{h}-0}{h} = \frac{\abs{h}}{h}\).

当\(h < 0\)时，\(\frac{\abs{h}}{h} = -1\)，
故\(\lim\limits_{h\to0^-}\frac{f(0+h)-f(0)}{h}
= \lim\limits_{h\to0^-}\frac{\abs{h}}{h} = -1\).

当\(h > 0\)时，\(\frac{\abs{h}}{h} = 1\)，
故\(\lim\limits_{h\to0^+}\frac{f(0+h)-f(0)}{h}
= \lim\limits_{h\to0^+}\frac{\abs{h}}{h} = 1\).

综上，\(\lim\limits_{h\to0}\frac{f(0+h)-f(0)}{h}\)不存在，即函数\(f(x) = \abs{x}\)在\(x = 0\)处不可导.
\end{solution}
\end{example}

\subsection{导数的几何意义}
\begin{theorem}
曲线\(y=f(x)\)在点\(M(x_0,y_0)\)处的\DefineConcept{切线方程}为\[
	y-y_0=f'(x_0)(x-x_0).
\]

过切点\(M(x_0,y_0)\)且与切线垂直的直线叫做曲线\(y=f(x)\)在点\(M\)处的\DefineConcept{法线}.
如果\(f'(x_0) \neq 0\)，则法线的斜率为\(-\frac{1}{f'(x_0)}\)，从而法线方程为\[
	y-y_0=-\frac{1}{f'(x_0)}(x-x_0);
\]
而如果\(f'(x_0) = 0\)，则法线方程为\(x = x_0\).
\end{theorem}

\subsection{函数可导性与连续性的关系}
\begin{theorem}\label{theorem:导数与微分.函数可导性与连续性的关系}
如果函数\(y = f(x)\)在点\(x_0\)处可导，则函数在该点必连续.
\begin{proof}
因为函数\(y = f(x)\)在点\(x_0\)处可导，所以极限\[
f'(x_0) = \lim\limits_{x \to x_0}\frac{f(x)-f(x_0)}{x-x_0} = A
\]存在，也就是说\[
\forall \varepsilon_1 > 0, \exists \delta_1 > 0 \left(
	0 < \abs{x-x_0} < \delta_1 \implies \abs{\frac{f(x)-f(x_0)}{x-x_0} - A} < \varepsilon_1
\right).
\]

由\(\abs{\frac{f(x)-f(x_0)}{x-x_0} - A} < \varepsilon_1\)可得\[
\abs{\abs{f(x)-f(x_0)} - \abs{A(x-x_0)}}
\leq \abs{f(x)-f(x_0) - A(x-x_0)}
< \varepsilon_1 \abs{x-x_0},
\]\[
\abs{f(x)-f(x_0)} < (\abs{A} + \varepsilon_1) \abs{x-x_0},
\]只要取\(\varepsilon_2 = (\abs{A} + \varepsilon_1) \abs{x-x_0}\)即有\(\abs{f(x)-f(x_0)} < \varepsilon_2\).
\end{proof}
\end{theorem}
借用\cref{definition:函数族.连续函数族} 和\cref{definition:函数族.可导函数族} 的记号，
可以将\cref{theorem:导数与微分.函数可导性与连续性的关系} 描述为：\[
D(I) \subseteq C(I).
\]

但是，一个函数在某点连续却不一定在该点可导.
\begin{example}
函数\(y=f(x)=\sqrt[3]x\)在区间\((-\infty,+\infty)\)内连续，但是在点\(x=0\)处不可导.这是因为在点\(x=0\)处有\[
\frac{f(0+h)-f(0)}{h}
=\frac{\sqrt[3]{h}-0}{h}
=\frac{1}{h^{2/3}}>0,
\]因而，\(\lim\limits_{h\to0}\frac{f(0+h)-f(0)}{h}=\lim\limits_{h\to0}\frac{1}{h^{2/3}}=\infty\)，即导数为无穷大（注意，导数不存在）.这事实在图形中表现为曲线\(y=\sqrt[3]x\)在原点具有垂直于\(x\)轴的切线\(x=0\).
\end{example}

\begin{example}
函数\(y=\sqrt{x^2}\)（即\(y=\abs{x}\)）在\((-\infty,+\infty)\)内连续，但是该函数在\(x=0\)处不可导，曲线\(y=\sqrt{x^2}\)在原点没有切线.
\end{example}

\begin{example}
函数\[
W(x) = \lim\limits_{n\to\infty} \sum\limits_{k=0}^n a^k \cos(b^k \pi x),
\]称为\DefineConcept{魏尔斯特拉斯函数}，它的参数\(a\)和\(b\)满足\(0<a<1, b\in\Set{ p \given p = 2q+1, q\in\mathbb{N} }, ab > 1+\frac{3}{2}\pi\).
可以证明，魏尔斯特拉斯函数在定义域上处处连续而又处处不可导.
\end{example}

由上可知，函数在某点连续是函数在该点可导的必要条件，但不是充分条件.

\section{函数的求导法则}
\subsection{函数的和、差、积、商的求导法则}
\begin{theorem}
如果函数\(u=u(x)\)和\(v=v(x)\)都在点\(x\)具有导数，那么它们的和、差、积、商（除分母为零的点外）都在点\(x\)具有导数，且
\begin{enumerate}
\item \((u \pm v)' = u' \pm v'\)；
\item \((uv)' = u'v + uv'\)；
\item \(\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2} \quad(v \neq 0)\).
\end{enumerate}
\begin{proof}
显然有
\begin{enumerate}
\item \begin{align*}
&[u(x) \pm v(x)]'
=\lim\limits_{\increment x\to0} \frac{[u(x+\increment x) \pm v(x+\increment x)]-[u(x) \pm v(x)]}{\increment x} \\
&=\lim\limits_{\increment x\to0} \frac{u(x+\increment x)-u(x)}{\increment x} \pm \lim\limits_{\increment x\to0} \frac{v(x+\increment x)-v(x)}{\increment x} \\
&=u'(x) \pm v'(x).
\end{align*}
\item \begin{align*}
&[u(x) v(x)]'
=\lim\limits_{\increment x\to0} \frac{u(x+\increment x) v(x+\increment x) - u(x) v(x)}{\increment x} \\
&=\lim\limits_{\increment x\to0} \left[
 \frac{u(x+\increment x) - u(x)}{\increment x} v(x+\increment x) + u(x) \frac{v(x+\increment x) - v(x)}{\increment x}
 \right] \\
&=\lim\limits_{\increment x\to0} \frac{u(x+\increment x) - u(x)}{\increment x} %
 \lim\limits_{\increment x\to0} v(x+\increment x) %
 + u(x) \lim\limits_{\increment x\to0} \frac{v(x+\increment x)-v(x)}{\increment x} \\
&=u'(x) v(x) + u(x) v'(x).
\end{align*}
\item \begin{align*}
&\left[ \frac{u(x)}{v(x)} \right]'
= \lim\limits_{\increment x\to0} \frac{1}{\increment x} \left[
 \frac{u(x+\increment x)}{v(x+\increment x)} - \frac{u(x)}{v(x)}
 \right] \\
&= \lim\limits_{\increment x\to0} \frac{u(x+\increment x) v(x) - u(x) v(x+\increment x)}{v(x+\increment x) v(x) \increment x} \\
&= \lim\limits_{\increment x\to0} \frac{[u(x+\increment x) - u(x)] v(x) - u(x) [v(x+\increment x) - v(x)]}{v(x+\increment x) v(x) \increment x} \\
&= \lim\limits_{\increment x\to0} \frac{1}{v(x+\increment x) v(x)} \left[
 \frac{u(x+\increment x) - u(x)}{\increment x} v(x) - u(x) \frac{v(x+\increment x) - v(x)}{\increment x}
 \right] \\
&= \frac{u'(x) v(x) - u(x) v'(x)}{v^2(x)}.
\qedhere
\end{align*}
\end{enumerate}
\end{proof}
\end{theorem}

\begin{corollary}
如果函数\(u=u(x)\)在点\(x\)具有导数，那么\[
(C u)' = C u'.
\]
\end{corollary}

\begin{corollary}
如果函数\(u=u(x)\)、\(v=v(x)\)和\(w=w(x)\)都在点\(x\)具有导数，那么\[
(uvw)' = [(uv)w]' = (uv)'w + (uv)w' = u'vw + uv'w + uvw'.
\]
\end{corollary}

\begin{example}
求正切函数\(y=\tan x\)的导数.
\begin{solution}
\((\tan x)'
= \left(\frac{\sin x}{\cos x}\right)'
= \frac{(\sin x)' \cos x - \sin x (\cos x)'}{(\cos x)^2}
= \frac{\cos^2 x + \sin^2 x}{\cos^2 x}
= \frac{1}{\cos^2 x}
= \sec^2 x\).
\end{solution}
\end{example}

\begin{example}
求正割函数\(y=\sec x\)的导数.
\begin{solution}
\((\sec x)'
= \left(\frac{1}{\cos x}\right)'
= \frac{(1)' \cdot \cos x - 1 \cdot (\cos x)'}{(\cos x)^2}
= \frac{\sin x}{\cos^2 x}
= \sec x \tan x\).
\end{solution}
\end{example}

\subsection{反函数的求导法则}
\begin{theorem}
如果函数\(x=f(y)\)在区间\(I_y\)内单调、可导且\(f'(y) \neq 0\)，则它的反函数\(y=f^{-1}(x)\)在区间\(I_x=\{x \mid x=f(y), y \in I_y\}\)内也可导，且\[
[f^{-1}(x)]'=\frac{1}{f'(y)}
\quad\text{或}\quad
\dv{y}{x} = \left(\dv{x}{y}\right)^{-1}.
\]

简单地说，反函数\(y=f^{-1}(x)\)的导数等于直接函数\(x=f(y)\)导数的倒数.
\end{theorem}

\begin{example}
求\(y=\arcsin x\ (-1<x<1)\)的导数.
\begin{solution}
由直接函数\(x=\sin y\)，有\[
	\dv{x}{y}
	= \dv{y} \sin y
	= \cos y,
\]则\[
	(\arcsin x)'
	= \dv{y}{x}
	= \left(\dv{x}{y}\right)^{-1}
	= \frac{1}{\cos y}.
\]
因为\(y \in (-\frac{\pi}{2},\frac{\pi}{2})\)，
\(\cos y \in (0,1]\)，
所以\(\cos y = \sqrt{1 - \sin^2 y} = \sqrt{1 - x^2}\)，
则\[
	(\arcsin x)' = \frac{1}{\sqrt{1 - x^2}}.
\]
\end{solution}
\end{example}

类似地，可得\[
	(\arccos x)' = \frac{-1}{\sqrt{1 - x^2}}.
\]

\begin{example}
求\(y=\arctan x\)和\(y=\arccot x\)的导数.
\begin{solution}
由直接函数\(x=\tan y\)，有\[
	\dv{x}{y}
	= \dv{y} \tan y
	= \sec^2 y
	= 1 + \tan^2 y
	= 1 + x^2,
\]
那么\[
	(\arctan x)' = \frac{1}{1+x^2}.
\]
\end{solution}
\end{example}

类似地，可得\[
	(\arccot x)' = \frac{-1}{1+x^2}.
\]

\begin{example}
求\(y=\log_a x\)的导数，其中\(a\in(0,1)\cup(1,+\infty)\).
\begin{solution}
由直接函数\(x=a^y\)，有\[
	\dv{x}{y} = \dv{y} a^y = a^y \ln a \neq 0,
\]
那么\[
	(\log_a x)' = \frac{1}{a^y \ln a} = \frac{1}{x \ln a}.
\]
\end{solution}
\end{example}

\subsection{复合函数的求导法则}
\begin{theorem}
如果\(u=g(x)\)在点\(x\)可导，而\(y=f(u)\)在点\(u=g(x)\)可导，则复合函数\(y=f[g(x)]\)在点\(x\)可导，且其导数为\[
\dv{y}{x} = f'(u) \cdot g'(x)
\quad\text{或}\quad
\dv{y}{x} = \dv{y}{u} \cdot \dv{u}{x}.
\]
\end{theorem}
复合函数的求导法则可以推广到多个中间变量的情形.
设\(y=f(u)\)，\(u=\varphi(v)\)，\(v=\psi(x)\)，则复合函数\(y=f\{\varphi[\psi(x)]\}\)的导数为\[
\dv{y}{x} = \dv{y}{u} \cdot \dv{u}{v} \cdot \dv{v}{x}.
\]

上述复合函数的求导公式也称作\DefineConcept{链式法则}（chain rule）.

\subsection{行列式函数的求导法则}
\begin{theorem}
\def\f#1{f_{#1}(x)}%
\def\g#1{f_{#1}'(x)}%
设函数\[
f(x) = \begin{vmatrix}
\f{11} & \f{12} & \dots & \f{1n} \\
\vdots & \vdots & & \vdots \\
\f{i1} & \f{i2} & \dots & \f{in} \\
\vdots & \vdots & & \vdots \\
\f{n1} & \f{n2} & \dots & \f{nn}
\end{vmatrix}
\]的任意分量函数都可导（即\(\f{ij}\ (i,j=1,2,\dotsc,n)\)可导），那么\(f(x)\)可导，且\[
\dv{x} f(x) = \sum\limits_{i=1}^n \begin{vmatrix}
\f{11} & \f{12} & \dots & \f{1n} \\
\vdots & \vdots & & \vdots \\
\g{i1} & \g{i2} & \dots & \g{in} \\
\vdots & \vdots & & \vdots \\
\f{n1} & \f{n2} & \dots & \f{nn}
\end{vmatrix}.
\]
\end{theorem}

\subsection{对数导数}
\begin{definition}
设函数\(f\colon I \to \mathbb{R}, f \in D(I)\)，
我们把\[
	\dv{x} \ln f(x)
\]称为“函数\(f\)的\DefineConcept{对数导数}（logarithmic derivative）”.
%@see: https://mathworld.wolfram.com/LogarithmicDerivative.html
\end{definition}

\section{高阶导数}
\subsection{函数的\texorpdfstring{\(n\)}{n}阶导数}
\begin{definition}
一般地，函数\(y=f(x)\)的导数\(y'=f'(x)\)仍然是\(x\)的函数.
我们把\(y'=f'(x)\)的导数叫做函数\(y=f(x)\)的\DefineConcept{二阶导数}，
记作\[
	y''
	\quad\text{或}\quad
	\dv[2]{y}{x},
	\]
即\[
	y''=(y')'
	\quad\text{或}\quad
	\dv[2]{y}{x}=\dv{x}(\dv{y}{x}).
\]

相应地，把\(y=f(x)\)的导数\(y'(x)\)叫做函数\(y=f(x)\)的\DefineConcept{一阶导数}.

类似地，二阶导数的导数叫做\DefineConcept{三阶导数}，记作\[
	y'''
	\quad\text{或}\quad
	\dv[3]{y}{x};
\]
三阶导数的导数叫做\DefineConcept{四阶导数}，记作\[
	y^{(4)}
	\quad\text{或}\quad
	\dv[4]{y}{x};
\]
以此类推，\((n-1)\)阶导数的导数叫做 \DefineConcept{\(n\)阶导数}，记作\[
	y^{(n)}
	\quad\text{或}\quad
	\dv[n]{y}{x}.
\]
二阶及二阶以上的导数统称\DefineConcept{高阶导数}.

特别地，规定：\[
	f^{(0)}(x) = f(x).
\]

函数\(y=f(x)\)具有\(n\)阶导数，也常说成“函数\(f(x)\)为\(n\)阶可导”.
\end{definition}

\begin{theorem}
设\(u=u(x)\)和\(v=v(x)\)都\(n\)阶可导，则
\begin{equation}
	(u \pm v)^{(n)} = u^{(n)} \pm v^{(n)}.
\end{equation}
\end{theorem}

\begin{theorem}
设\(u=u(x)\)和\(v=v(x)\)都\(n\)阶可导，则
\begin{equation}\label{equation:导数与微分.莱布尼茨公式}
	(u v)^{(n)}
	= \sum_{k=0}^n C_n^k u^{(n-k)} v^{(k)}.
\end{equation}
\end{theorem}
\cref{equation:导数与微分.莱布尼茨公式} 称为\DefineConcept{莱布尼茨公式}.

\begin{definition}\label{definition:函数族.n阶可导函数族}
由区间\(I\)上全部的\(n\)阶可导函数组成的集合，
称作\(n\)阶\DefineConcept{可导函数族}，
记作\(D^n(I)\)，即\[
	D^n(I)
	\defeq
	\Set*{
		f\in\mathbb{R}^I
		\given
		(\forall i\in[0,n-1]\cap\mathbb{Z})
		[f^{(i)} \in D(I)]
	}.
\]
\end{definition}

\begin{definition}\label{definition:函数族.n阶连续可导函数族}
由区间\(I\)上全部的\(n\)阶连续可导函数组成的集合，
称作\(n\)阶\DefineConcept{连续可导函数族}，
记作\(C^n(I)\)，即\[
	C^n(I)
	\defeq
	\Set*{
		f\in\mathbb{R}^I
		\given
		[f\in D^n(I)]
		\land
		[f^{(n)}\in C(I)]
	}.
\]
\end{definition}

\begin{theorem}
如果函数\(f(x)\)在点\(x\)处具有\(n\)阶导数，
那么\(f(x)\)在点\(x\)的某一邻域内必定具有一切低于\(n\)阶的导数.
\end{theorem}
换句话说，\(
C(I) \supseteq
D(I) = D^1(I) \supseteq
C^1(I) \supseteq
D^2(I) \supseteq
C^2(I) \supseteq
D^3(I) \supseteq
\dotsb
\).

\subsection{光滑函数}
\begin{definition}\label{definition:函数族.光滑函数族}
定义：\[
	D^\infty (I) \defeq \bigcap\limits_{n\geq1} D^n(I),
\]\[
	C^\infty (I) \defeq \bigcap\limits_{n\geq1} C^n(I).
\]

称函数\(f \in C^\infty (I)\)为\(I\)上的\DefineConcept{光滑函数}（smooth function）.
\end{definition}

\begin{property}\label{theorem:函数族.光滑函数族的性质1}
\(D^\infty (I) = C^\infty (I)\).
\end{property}

\section{隐函数及由参数方程所确定的函数的导数}\label{section:导数与微分.隐函数及由参数方程所确定的函数的导数}
\subsection{隐函数的导数}
\begin{definition}
形如\(y=f(x)\)的函数，在等号左端是因变量的符号，而右端是含有自变量的式子，当自变量取定义域内任一值时，由这个式子能确定对应的函数.用这种方式表达的函数叫做\DefineConcept{显函数}.
相对地，形如\(g(x,y)=0\)的函数，称为\DefineConcept{隐函数}.
把一个隐函数化为显函数，叫做\DefineConcept{隐函数的显化}.
\end{definition}

\begin{example}
例如从方程\(x+y^3-1=0\)解出\(y=\sqrt[3]{1-x}\)，就把隐函数化成了显函数.
\end{example}

\begin{example}
求由方程\(e^y + xy - e = 0\)所确定的隐函数的导数\(\displaystyle\dv{y}{x}\).
\begin{solution}
把方程两边分别对\(x\)求导得\[
\dv{x}(e^y+xy-e) = e^y \dv{y}{x} + y + x \dv{y}{x} = 0,
\]解得\[
\dv{y}{x} = -\frac{y}{x+e^y},
\quad x+e^y \neq 0.
\]在这个结果中，分式中的\(y=y(x)\)是由方程\(e^y + xy - e = 0\)所确定的隐函数.
\end{solution}
\end{example}

\begin{example}
求椭圆\(\frac{x^2}{16}+\frac{y^2}{9}=1\)在点\(\opair{2,\frac{3}{2}\sqrt3}\)处的切线方程.
\begin{solution}
由导数的几何意义可知，所求切线的斜率为\[
k = \eval{y'}_{x=2}.
\]

椭圆方程的两边分别对\(x\)求导，得\[
\frac{x}{8}+\frac{2}{9}y\dv{y}{x}=0,
\]\[
\dv{y}{x}=-\frac{9x}{16y}.
\eqno{(1)}
\]

当\(x=2\)时，\(y=\frac{3}{2}\sqrt3\)，代入(1)式可得\[
\eval{\dv{y}{x}}_{x=2}=-\frac{\sqrt3}{4}.
\]于是所求的切线方程为\[
y-\frac{3}{2}\sqrt3 = -\frac{\sqrt3}{4}(x-2),
\]即\[
\sqrt3 x + 4 y - 8\sqrt3 = 0.
\]
\end{solution}
\end{example}

\begin{lemma}
设函数\(y=\ln\abs{x}\).当\(x\neq0\)时，\(y'=1/x\).
\end{lemma}
在某些场合，利用所谓\emph{对数求导法}求导数比用通常的方法简便些，它适用于求解函数的积、商，根式形式、幂形式、指数形式或幂指形式的函数.
这种方法是先在\(y=f(x)\)的两边取对数，然后再求出\(y\)的导数\(y'\).但要注意，因为对数运算要求其真数必须大于零（即\(\log_a x \implies x>0\)），所以在使用对数求导法时，一定要注意\(f(x)\)的定义域.

\begin{example}
求\(y=x^{\sin x}\ (x>0)\)的导数.
\begin{solution}
因为\(x > 0\)，
所以\(y=x^{\sin x} > 0\).
对函数等式两边取对数得\[
	\ln y = \sin x \ln x,
\]
对上式两边求导得\[
	\frac{y'}{y} = \cos x \ln x + \sin x \frac{1}{x},
\]\[
	y' = x^{\sin x} \left( \cos x \ln x + \frac{\sin x}{x} \right).
\]
\end{solution}
\end{example}

\begin{theorem}
对于一般形式的幂指函数\[
	y = u^v, \quad u > 0,
\]
如果\(u=u(x),v=v(x)\)都可导，则\[
	y' = \dv{x}e^{v \ln u} = u^v \left( v' \ln u + \frac{u'v}{u} \right).
\]
\end{theorem}
这里一定要注意\(u>0\)这个条件，它是函数\(\ln u\)对定义域的要求.

\begin{example}
求\(y=\sqrt{\frac{(x-1)(x-2)}{(x-3)(x-4)}}\)的导数.
\begin{solution}
由\(\frac{(x-1)(x-2)}{(x-3)(x-4)}\geq0\)
得\(x \in (-\infty,1]\cup[2,3)\cup(4,+\infty)\).
这就是函数\(y=y(x)\)的定义域.

当\(x>4\)时，对函数式两边取对数，得\[
	\ln y = \frac{1}{2} \bigl[
		\ln(x-1)+\ln(x-2)-\ln(x-3)-\ln(x-4)
	\bigr],
\]
上式两边对\(x\)求导，得\[
	\frac{y'}{y} = \frac{1}{2} \left(
		\frac{1}{x-1} + \frac{1}{x-2} - \frac{1}{x-3} - \frac{1}{x-4}
	\right),
\]
于是\[
	y' = \frac{y}{2} \left(
		\frac{1}{x-1} + \frac{1}{x-2} - \frac{1}{x-3} - \frac{1}{x-4}
	\right).
\]

当\(x<1\)时，对原函数变形得\(y=\sqrt{\frac{(1-x)(2-x)}{(3-x)(4-x)}}\)；
当\(2<x<3\)时，对原函数变形得\(y=\sqrt{\frac{(x-1)(x-2)}{(3-x)(4-x)}}\)；
用同样的方法可得与上面相同的结果.
\end{solution}
\end{example}

\begin{example}
已知双曲线\(C: y^2 = 2px\ (p>0)\)，
过它的焦点弦\(PQ\)的两个端点作它的两条切线，求这两条切线的交点的坐标.
\begin{solution}
如下图，设直线\(l: y=k\left(x-\frac{p}{2}\right)\)（不妨设\(k>0\)）
与双曲线\(C\)相交于\(P\opair{x_1,y_1},Q\opair{x_2,y_2}\)两点.
\begin{center}
\begin{tikzpicture}
%\draw[gray,help lines,dashed] (-3,-3) grid (3,3);
\draw[thick,->] (-2,0) -> (4,0)node[above]{\(x\)};
\draw[thick,->] (0,-4) -> (0,4)node[right]{\(y\)};
\draw (0,0)node[below right]{\(O\)};
\pgfmathsetmacro{\p}{2}  % 参数p
\pgfmathsetmacro{\x}{3}
\pgfmathsetmacro{\y}{sqrt(2*\p*\x)}
\pgfmathsetmacro{\f}{\p/2}  % 焦点横坐标
\coordinate (F)at(\f,0);
\coordinate (2F)at(2\f,0);
\draw[orange] [rotate=-90](0,0)parabola(\y,\x) [rotate=180](0,0)parabola(\y,-\x);
\draw[purple] (-\f,-4)--(-\f,4); % 准线
\draw (2,-3)node[above right]{\(C\)};
\pgfmathsetmacro{\k}{3}  % 焦点弦 斜率
\pgfmathsetmacro{\a}{\p/(2*\k^2)}
\pgfmathsetmacro{\b}{\p/\k}
\pgfmathsetmacro{\c}{sqrt(\k^2+1)}
\pgfmathsetmacro{\px}{\a*(\c+1)^2}  % x_1
\pgfmathsetmacro{\py}{\b*(\c+1)}  % y_1
\pgfmathsetmacro{\qx}{\a*(\c-1)^2}  % x_2
\pgfmathsetmacro{\qy}{-\b*(\c-1)}  % y_2
\pgfmathsetmacro{\sx}{-\p/2}  % x_0
\pgfmathsetmacro{\sy}{\p/\k}  % y_0
\coordinate (P)at(\px,\py);
\coordinate (Q)at(\qx,\qy);
\coordinate (S)at(\sx,\sy);
\draw[blue] (P)--(F)--(Q);
\draw (P)--(S)--(Q);
\draw pic["\(\theta\)",draw=gray,-,angle eccentricity=1.7,angle radius=5mm]{angle=2F--F--P};
\fill (P)circle(2pt)node[below right]{\(P\)}
	(F)circle(2pt)node[below right]{\(F\)}
	(Q)circle(2pt)node[right]{\(Q\)}
	(S)circle(2pt)node[left]{\(S\)};
\end{tikzpicture}
\end{center}
那么\[
x_1 = \frac{p}{2 k^2} (\sqrt{k^2+1} + 1)^2,
\qquad
y_1 = \frac{p}{k} (1+\sqrt{k^2+1}),
\]\[
x_2 = \frac{p}{2 k^2} (\sqrt{k^2+1} - 1)^2,
\qquad
y_2 = \frac{p}{k} (1-\sqrt{k^2+1}).
\]

隐函数\(y^2 = 2px\)对\(x\)求导，得\[
2 y \dv{y}{x} = 2 p,
\]整理得\[
\dv{y}{x} = \frac{p}{y},
\]所以\[
k_1 = \eval{\dv{y}{x}}_{\substack{x=x_1\\y=y_1}}
= \frac{k}{1+\sqrt{k^2+1}},
\qquad
k_2 = \eval{\dv{y}{x}}_{\substack{x=x_2\\y=y_2}}
= \frac{k}{1-\sqrt{k^2+1}}.
\]

那么抛物线过点\(P\)和点\(Q\)的切线的方程为\[
l_1: y-y_1 = k_1 (x-x_1),
\]\[
l_2: y-y_2 = k_2 (x-x_2).
\]联立切线方程，消去\(y\)，得\[
y_1 + k_1(x - x_1) = y_2 + k_2(x - x_2),
\]移项得\[
(k_1 - k_2) x = y_2 - y_1 + k_1 x_1 - k_2 x_2,
\]解得\[
x_0 = \frac{y_2 - y_1 + k_1 x_1 - k_2 x_2}{k_1 - k_2}
= -\frac{p}{2},
\]代入得\[
y_0 = y_1 + k_1(x_0 - x_1)
= \frac{p}{k}.
\]综上所述，所求的交点坐标为\[
\opair*{-\frac{p}{2},\frac{p}{k}}.
\]
\end{solution}
\end{example}

\subsection{由参数方程所确定的函数的导数}
\begin{theorem}
对于参数方程\[
	\left\{ \begin{array}{l}
		x = \varphi(t), \\
		y = \psi(t)
	\end{array} \right.,
\]
若函数\(x = \varphi(t)\)具有单调连续反函数\(t=\varphi^{-1}(x)\)，
且该反函数可与函数\(y = \psi(t)\)构成复合函数（即函数\(y=f(x)\)
可以看作\(y=\psi(t)\)和\(t=\varphi^{-1}(x)\)复合而成的函数\(y=\psi[\varphi^{-1}(x)]\)），
且函数\(x = \varphi(t)\)和\(y = \psi(t)\)都可导，且\(\varphi'(t) \neq 0\)，
则由复合函数的求导法则与反函数的求导法则，就有\[
	\dv{y}{x} = \dv{y}{t} \cdot \dv{t}{x}
	= \dv{y}{t} \cdot \left(\dv{x}{t}\right)^{-1}
	= \frac{\psi'(t)}{\varphi'(t)}.
\]

若函数\(x = \varphi(t)\)和\(y = \psi(t)\)是二阶可导的，那么\[
	\dv[2]{y}{x}
	= \dv{(y'_x)}{x}
	= \dv{(y'_x)}{t} \cdot \dv{t}{x}
	= \dv{(y'_x)}{t} \cdot \left(\dv{x}{t}\right)^{-1}
	= \frac{\psi''(t) \varphi'(t) - \psi'(t) \varphi''(t)}{\varphi'^3(t)}.
\]
\end{theorem}

\section{函数的微分}
\subsection{微分的定义}
\begin{definition}
设函数\(y=f(x)\)在某区间内有定义，\(x_0\)及\(x_0+\increment x\)在这区间内，如果函数增量\[
\increment y=f(x_0+\increment x)-f(x_0)
\]可表示为\[
\increment y=A\increment x+o(\increment x).
\]其中\(A\)是不依赖于\(\increment x\)的常数，那么称函数\(y=f(x)\)在点\(x_0\)是\DefineConcept{可微的}，而\(A\increment x\)叫做函数\(y=f(x)\)在点\(x_0\)相应于自变量增量\(\increment x\)的\DefineConcept{微分}，记作\(\dd{y}\)，即\[
\dd{y}=A\increment x.
\]称\(\dd{y}\)是\(\increment y\)的\DefineConcept{主部}.
又由于\(\dd{y}=f'(x_0)\increment x\)是\(\increment x\)的线性函数，所以在\(f'(x_0) \neq 0\)的条件下，称\(\dd{y}\)为\(\increment y\) 的\DefineConcept{线性主部}（当\(\increment x\to0\)）.
\end{definition}

\begin{property}
当\(\increment x\to0\)时，函数增量\(\increment y\)与函数微分\(\dd{y}\)是等价无穷小，即\[
\lim\limits_{\increment x\to0} \frac{\increment y}{\dd{y}}
= \lim\limits_{\increment x\to0} \frac{\increment y}{f'(x_0) \increment x}
= \frac{1}{f'(x_0)} \lim\limits_{\increment x\to0} \frac{\increment y}{\increment x}
= 1.
\]
\end{property}

\begin{theorem}
函数\(f(x)\)在点\(x_0\)可微的充要条件是：函数\(f(x)\)在点\(x_0\)可导.当\(f(x)\)在点\(x_0\)可微时，其微分一定是\[
\dd{y}=f'(x_0)\increment x.
\]
\end{theorem}

\subsection{微分的运算法则}
由函数的微分的表达式\(\dd{y} = f'(x) \dd{x}\)可知，要计算函数的微分，只要计算函数的导数，再乘以自变量的微分\(\dd{x}\)即可.

\begin{theorem}[函数和、差、积、商的微分法则]
\begin{gather*}
\dd(u \pm v) = \dd{u}\pm\dd{v} \\
\dd(C u) = C \dd{u} \\
\dd(u v) = v \dd{u} + u \dd{v} \\
\dd(\frac{u}{v}) = \frac{v \dd{u} - u \dd{v}}{v^2} \quad (v \neq 0)
\end{gather*}
\end{theorem}

\begin{theorem}[复合函数的微分法则]
设函数\(y=f(u)\)及\(u=g(x)\)都可导，则复合函数\(y=f[g(x)]\)的微分为\[
\dd{y}=y'_x\dd{x}=f'(u)g'(x)\dd{x}=\dv{y}{u}\dv{u}{x}\dd{x}.
\]

由于\(g'(x)\dd{x}=\dd{u}\)，所以，复合函数\(y=f[g(x)]\)的微分公式也可以写成\[
\dd{y}=y'_u\dd{u}=f'(u)\dd{u}=\dv{y}{u}\dd{u}.
\]由此可见，无论\(u\)是自变量还是中间变量，微分形式\(\dd{y}=f'(u)\dd{u}\)保持不变.这一性质称为\DefineConcept{微分形式不变性}.这性质表明，当变换自变量时，微分形式\(\dd{y}=f'(u)\dd{u}\)并不改变.
\end{theorem}

\subsection{微分在近似计算中的应用}
\subsubsection{函数的近似计算}
在工程问题中，经常会遇到一些复杂的计算公式.如果直接用这些公式进行计算，那是很费力的.利用微分往往可以把一些复杂的计算公式用简单的近似公式来代替.

前面说过，如果\(y=f(x)\)在点\(x_0\)处的导数\(f'(x_0)\neq0\)，且\(\abs{\increment x}\)很小时，我们有\[
\increment y \approx\dd{y} = f'(x_0) \increment x.
\]这个式子也可以写成\begin{gather}
\increment y = f(x_0 + \increment x) - f(x_0) \approx f'(x_0) \increment x, \tag1
\end{gather}或\begin{gather}
f(x_0 + \increment x) \approx f(x_0) + f'(x_0) \increment x. \tag2
\end{gather}

在上式令\(x = x_0 + \increment x\)，即\(\increment x = x - x_0\)，那么上式可改写为\begin{gather}
f(x) \approx f(x_0) + f'(x_0) (x - x_0). \tag3
\end{gather}

如果\(f(x_0)\)和\(f'(x_0)\)都容易计算，那么可利用(1)式来近似计算\(\increment y\)，利用(2)式来近似计算\(f(x_0 + \increment x)\)，或利用(3)式来近似计算\(f(x)\).这种近似计算的实质就是用\(x\)的线性函数\(f(x_0) + f'(x_0) (x - x_0)\)来近似表达函数\(f(x)\).从导数的几何意义可知，这也就是用曲线\(y=f(x)\)在点\(\opair{x_0,f(x_0)}\)处的切线来近似代替该曲线（就切点邻近部分来说）.

如果在(3)式中取\(x_0 = 0\)，可得\begin{gather}
f(x) \approx f(0) + f'(0) x. \tag4
\end{gather}

运用(4)式可以推得以下几个在工程上常用的近似公式（下面都假定\(\abs{x}\)是较小的数值）：
\begin{gather}
\sqrt[n]{1+x} \approx 1 + \frac{x}{n}, \\
\sin x \approx x, \\
\tan x \approx x, \\
e^x \approx 1 + x, \\
\ln (1 + x) \approx x.
\end{gather}

\subsubsection{误差估计}
在生产实践中，经常要测量各种数据.但是有的数据不易直接，这时我们就通过测量其他有关数据后，根据某种公式算出所要的数据.例如，要计算圆形钢柱的截面积\(A\)，可先用卡尺测量其截面的直径\(D\)，然后根据公式\(A = \frac{\pi}{4} D^2\)算出\(A\).

由于测量仪器的精度、测量的条件和测量的方法等各种因素的影响，测得的数据往往带有误差，而根据带有误差的数据计算所得的结果也会有误差，我们把它叫做\DefineConcept{间接测量误差}.

下面就讨论怎样利用微分来估计间接测量误差.先说明什么叫绝对误差、相对误差.

如果某个量的精确值为\(A\)，它的测量值（或近似值）为\(a\)，那么\(\abs{A-a}\)叫做\(a\)的\DefineConcept{绝对误差}，而绝对误差与\(\abs{a}\)的比值\(\frac{\abs{A-a}}{\abs{a}}\)叫做\(a\)的\DefineConcept{相对误差}.

在实际工作中，某个量的精确值往往是无法知道的，于是绝对误差和相对误差也就无法求得.但是根据测量仪器的精度等因素，有时能够确定误差在某一范围内.如果某个量的精确值是\(A\)，它的测量值（或近似值）是\(a\)，又知道它的误差不超过\(\delta_A\)，即\[
\abs{A-a} \leq \delta_A,
\]那么\(\delta_A\)叫做测量\(A\)的\DefineConcept{绝对误差限}，而\(\frac{\delta_A}{\abs{a}}\)叫做测量\(A\)的\DefineConcept{相对误差限}.

\begin{example}
设测得圆钢截面的直径\(D = 60.03\ mm\)，测量\(D\)的绝对误差限\(\delta_D = 0.05\ mm\).利用公式\[
A = \frac{\pi}{4} D^2
\]计算圆钢的截面积时，试估计面积的误差.
\begin{solution}
我们把测量\(D\)时所产生的误差当做自变量\(D\)的增量\(\increment D\)，那么，利用公式\(A = \frac{\pi}{4} D^2\)来计算\(A\)时所产生的误差就是函数\(A\)的对应增量\(\increment A\).当\(\abs{\increment D}\)很小时，可以利用微分\(\dd A\)近似地代替增量\(\increment A\)，即\[
\increment A \approx \dd A = A' \cdot \increment D = \frac{\pi}{2} D \cdot \increment D.
\]由于\(D\)的绝对误差限为\(\delta_D = 0.05\ mm\)，所以\[
\abs{\increment D} \leq \delta_D = 0.05,
\]而\[
\abs{\increment A} \approx \abs{\dd A} = \frac{\pi}{2} D \cdot \abs{\increment D} \leq \frac{\pi}{2} D \cdot \delta_D,
\]因此得出\(A\)的绝对误差限约为\[
\delta_A = \frac{\pi}{2} D \cdot \delta_D = \frac{\pi}{2} \times 60.03 \times 0.05 \approx 4.715\ (\mathrm{mm}^2);
\]\(A\)的相对误差限约为\[
\frac{\delta_A}{A} = \frac{\frac{\pi}{2} D \cdot \delta_D}{\frac{\pi}{4} D^2}
= 2 \frac{\delta_D}{D} = 2 \times \frac{0.05}{60.03} \approx 0.17\%.
\]
\end{solution}
\end{example}

一般地，根据直接测量的\(x\)值按公式\(y = f(x)\)计算\(y\)值时，如果已知测量\(x\)的绝对误差限是\(\delta_x\)，即\[
\abs{\increment x} \leq \delta_x,
\]那么，当\(y' \neq 0\)时，\(y\)的绝对误差\[
\abs{\increment y} \approx \abs{\dd{y}} = \abs{y'} \cdot \abs{\increment x} \leq \abs{y'} \cdot \delta_x,
\]即\(y\)的绝对误差限约为\[
\delta_y = \abs{y'} \cdot \delta_x;
\]\(y\)的相对误差限约为\[
\frac{\delta_y}{\abs{y}} = \abs{\frac{y'}{y}} \cdot \delta_x.
\]

\section{本章总结}
\subsection{常见导数公式}
\begin{gather*}
(C)' = 0, \\
(x^\mu)' = \mu x^{\mu-1}, \\
(\sin x)' = \cos x, \\
(\cos x)' = - \sin x, \\
(\tan x)' = \sec^2 x, \\
(\cot x)' = - \csc^2 x, \\
(\sec x)' = \sec x \tan x, \\
(\csc x)' = - \csc x \cot x, \\
(a^x)' = a^x \ln a, \\
(e^x)' = e^x, \\
(\log_a x)' = \frac{1}{x \ln a}, \\
(\ln x)' = \frac{1}{x}, \\
(\sqrt[n]{x})' = \frac{\sqrt[n]{x}}{n x}, \\
(\sqrt{x})' = \frac{1}{2\sqrt{x}}, \\
\left(\frac{1}{x^n}\right)' = -\frac{n}{x^{n+1}}, \\
\left(\frac{1}{x}\right)' = -\frac{1}{x^2}, \\
(\sinh x)' = \cosh x, \\
(\cosh x)' = \sinh x, \\
(\tanh x)' = \frac{1}{\cosh^2 x}, \\
(\arcsin x)' = \frac{1}{\sqrt{1 - x^2}}, \\
(\arccos x)' = - \frac{1}{\sqrt{1 - x^2}}, \\
(\arctan x)' = \frac{1}{1 + x^2}, \\
(\arccot x)' = - \frac{1}{1 + x^2}, \\
(\arsinh x)' = \frac{1}{\sqrt{1 + x^2}}, \\
(\arcosh x)' = \frac{1}{\sqrt{x^2 - 1}} \quad (x > 1), \\
(\artanh x)' = \frac{1}{1 - x^2} \quad (-1 < x < 1), \\
(e^x)^{(n)} = e^x, \\
(a^x)^{(n)} = a^x \ln^n a, \\
(\sin x)^{(n)} = \sin \left( x + n \cdot \frac{\pi}{2} \right), \\
(\cos x)^{(n)} = \cos \left( x + n \cdot \frac{\pi}{2} \right), \\
(x^\mu)^{(n)} = x^{\mu-n}\prod_{k=0}^{n-1} {(\mu - k)}, \\
(x^n)^{(n)} = n!, \\
(x^n)^{(n+1)} = 0, \\
[\ln(1+x)]^{(n)} = (-1)^{n-1} \frac{(n-1)!}{(1+x)^n}.
\end{gather*}
